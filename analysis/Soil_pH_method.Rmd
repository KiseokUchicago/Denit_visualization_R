---
title: "Soil_pH_method"
author: "KiseokUchicago"
date: "2021-09-24"
output: workflowr::wflow_html
editor_options:
  chunk_output_type: console
---
```{r global_options, include=FALSE}
knitr::opts_chunk$set(fig.width=11, fig.height=9,
                      error=TRUE, echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE)
```

## Soil pH measurement method testing

Researcher: **Kiseok Lee** \
Experimental date: 9/14/21 and 9/28/21 \
Lab: **Seppe Kuehn**

```{r}
# libraries
library(dplyr)
library(ggplot2)
library(RColorBrewer)
library(vegan)
library(tidyverse)
library(magrittr)
library(readxl)
library(reshape2)
library(gtools)
library(devtools)
library(openxlsx)
library(ape)
library(stringr)
library(tidyr)

## theme for ggplot
mytheme <- theme_bw() + 
  theme(plot.title = element_text(size = 19,hjust = 0.5, family="serif")) + 
  theme(axis.title.x = element_text(size = 17,hjust = 0.5, family="serif")) + 
  theme(axis.title.y = element_text(size = 17,hjust = 0.5, family="serif")) + 
  theme(axis.text.x = element_text(hjust = 0.5, vjust=0.3,size=13, family="serif"))+
  theme(axis.text.y = element_text(size=10, family="serif"))+
  theme(panel.grid.major = element_blank()) +
  theme(panel.grid.minor = element_blank(),panel.background=element_blank(),panel.border=element_blank(),plot.background=element_blank()) +
  theme(axis.ticks = element_line(size = 1.1))

mytheme_2d <- theme_bw() + 
  theme(plot.title = element_text(size = 19,hjust = 0.5, family="serif")) + 
  theme(axis.title.x = element_text(size = 17,hjust = 0.5, family="serif")) + 
  theme(axis.title.y = element_text(size = 17,hjust = 0.5, family="serif")) + 
  theme(axis.text.x = element_text(hjust = 0.5, vjust=0.3,size=13, family="serif"))+
  theme(axis.text.y = element_text(size=13, family="serif"))+
  # theme(panel.grid.major = element_blank()) +
  # theme(panel.grid.minor = element_blank(),panel.background=element_blank(),plot.background=element_blank()) +
  theme(axis.ticks = element_line(size = 1.1))


# color collection
my_color_collection <- c(
  "#CBD588", "#5F7FC7", "orange", "#AD6F3B", "#673770", 
  "#D14285", "#652926", "#C84248", "#8569D5", "#5E738F",
  "#D1A33D", "#8A7C64", "#599861","#616163", "#FFCDB2",
  "#6D9F71", "#242F40",
  "#CCA43B", "#F92A82", "#ED7B84", "#7EB77F", 
  "#DEC4A1", "#E5D1D0", '#0E8482', '#C9DAEA', '#337357', 
  '#95C623', '#E55812', '#04471C', '#F2D7EE', '#D3BCC0', 
  '#A5668B', '#69306D', '#0E103D', '#1A535C', '#4ECDC4', 
  '#F7FFF7', '#FF6B6B', '#FFE66D', '#6699CC', '#FFF275', 
  '#FF8C42', '#FF3C38', '#A23E48', '#000000', '#CF5C36', 
  '#EEE5E9', '#7C7C7C', '#EFC88B', '#2E5266', '#6E8898', 
  '#9FB1BC', '#D3D0CB', '#E2C044', '#5BC0EB', '#FDE74C', 
  '#9BC53D', '#E55934', '#FA7921', "#CD9BCD", "#508578", "#DA5724")

# for git push, use this instead of using wflow_git_push()
# git push -u origin master (in the Git app / in the working directory)

```

## Another experiment from 210914
## (1) Import data
```{r}
# import file
df_pH <- openxlsx::read.xlsx("data/pH_data(9.14.21).xlsx")
class(df_pH)
df_pH <- df_pH %>% rename(Method = X1)

df_pH_gg <- melt(df_pH ,variable.name = "Solution",value.name = "pH")
# Order the method
df_pH_gg$Method <- ordered(df_pH_gg$Method, levels=c("Stand_20min", "Spin_down", "Filter_0.22um"))


# remove NA
dim(df_pH_gg)
df_pH_gg2 <- na.omit(df_pH_gg)
dim(df_pH_gg2)

```

## (2) Plot
```{r}
# plot
ggplot(df_pH_gg2, aes(x=Method, y=pH, color=Solution, group=Solution)) +
  geom_point(size=2.5, shape=21) +
  geom_line(size=1)+
  scale_fill_brewer(palette='Set2') +
  ylab("pH \n") +
  xlab("\n Settling method") +
  scale_y_continuous(breaks = seq(6,7,0.05), limits=c(6.1, 7))+
  ggtitle("pH difference by method & solution \n") +
  # label
  geom_text(aes(label = pH), size = 3, vjust = -1.5, family="serif")+
  mytheme_2d
```

## Another experiment from 210928

## (1) Import data
```{r}
# import file
df_pH <- openxlsx::read.xlsx("data/pH_data(9.28.21).xlsx")
class(df_pH)
df_pH <- df_pH %>% rename(Method = X1)

df_pH_gg <- melt(df_pH ,variable.name = "Solution",value.name = "pH")
# Order the method
df_pH_gg$Method <- ordered(df_pH_gg$Method, levels=c("Stand_20min", "Spin_down", "Filter_0.22um", "Whatman"))


# remove NA
dim(df_pH_gg)

```

## 2. Plot
```{r}
# plot
ggplot(df_pH_gg, aes(x=Method, y=pH, color=Solution, group=Solution)) +
  geom_point(size=2.5, shape=21) +
  geom_line(size=1)+
  scale_fill_brewer(palette='Set2') +
  ylab("pH \n") +
  xlab("\n Settling method") +
  scale_y_continuous(breaks = seq(5,7,0.1), limits=c(5, 7))+
  ggtitle("pH difference by method & solution \n") +
  # label
  geom_text(aes(label = pH), size = 3, vjust = -1.5, family="serif", show.legend  = FALSE)+
  mytheme_2d
```

## Testing pH needle (non-destructive method)
Experimental date: 11/10/21 \
Analysis: 11/17/21 \

## 1. Import data
```{r}
# import file
df_pH <- openxlsx::read.xlsx("data/pH_data(11.17.21)-Midway_etc.xlsx")
class(df_pH)
df_pH <- df_pH %>% rename(Site = X1)

df_pH_gg <- melt(df_pH ,variable.name = "Method",value.name = "pH")

# Order the method
df_pH_gg$Method <- factor(df_pH_gg$Method, levels=c("pH_meter", "pH_needle"))

# remove NA
dim(df_pH_gg)

```

## 2. Plot
```{r}
# plot
ggplot(df_pH_gg, aes(x=Site, y=pH, color=Method, group=Method)) +
  geom_point(size=2.5, shape=21) +
  geom_line(size=1)+
  scale_fill_brewer(palette='Set2') +
  ylab("pH \n") +
  xlab("\n Site") +
  # scale_y_continuous(breaks = seq(5,7,0.1), limits=c(5, 7))+
  ggtitle("pH difference by method \n") +
  # label
  geom_text(aes(label = pH), size = 3, vjust = -1.5, family="serif", show.legend  = FALSE)+
  mytheme_2d

# 2d scatter plot
fit.pH <- lm(pH_meter ~ pH_needle, df_pH)

# Plot fitted linear regression line
ggplot(df_pH, aes(x=pH_needle, y=pH_meter)) +
  geom_point(size=3, color="deepskyblue4") +
  # geom_line(size=1)+
  # geom_errorbar(aes(ymin=NO3_mM - sd_NO3_mM, ymax=NO3_mM + sd_NO3_mM), width=.05)+
  # scale_color_brewer(palette='Set2') +
  # scale_color_manual(values = c("maroon2","deepskyblue4"))+
  ylab("pH measured in lab \n") +
  xlab("\n pH measured on site by needle ") +
  scale_y_continuous(breaks = seq(5,8,1), limits=c(5, 8))+
  scale_x_continuous(breaks = seq(5,8,1), limits=c(5, 8))+
  # geom_text_repel(aes(label = round(NO3_mM,3)), size = 3,family="serif", show.legend = FALSE)+
  ggtitle("pH measurement \n") +
  geom_abline(slope = 1, intercept=0, show.legend = "y=x")+
  # regression line
  geom_abline(slope = coef(fit.pH)[[2]], intercept = coef(fit.pH)[[1]],
              color = "maroon2") +
  # show equation
  # stat_cor(aes(label = paste(..rr.label.., ..p.label.., sep = "~`,`~"))) +
  annotate("text",x=6.5,y=8, label= paste0("y = ", round(coef(fit.pH)[[1]],3),"+",round(coef(fit.pH)[[2]],3),"x"), color = "maroon2") +
  mytheme_2d



```


## Testing pH colorimetric method
Experimental date: 12/01/21 \
Analysis: 12/06/21 \

## 1. Import data
```{r}
# import file
df_pH_color <- openxlsx::read.xlsx("data/211201_pH_colorimetric.xlsx")
df_pH_meter <- openxlsx::read.xlsx("data/pH_data(12.6.21)-Midway_incubation_endpoint.xlsx")
class(df_pH_color)
colnames(df_pH_color)
colnames(df_pH_meter)

head(df_pH_color)
dim(df_pH_color)

# 
# df_pH_gg <- melt(df_pH ,variable.name = "Method",value.name = "pH")
# 
# # Order the method
# df_pH_gg$Method <- factor(df_pH_gg$Method, levels=c("pH_meter", "pH_needle"))
# 
# # remove NA
# dim(df_pH_gg)

```

## 2. Plot
```{r}
# plot - Colorimetric value 
ggplot(df_pH_color, aes(x=pH, y=pH_colorimetric, color=Soil, group=Soil)) +
  geom_point(size=4, shape=16, alpha=0.7) +
  # geom_line(size=1)+
  # scale_color_brewer(palette='Set1') +
  ylab("Colorimetric pH value (mu = 0.059) \n") +
  xlab("\n Intended pH (without buffer)") +
  # scale_y_continuous(breaks = seq(5,7,0.1), limits=c(5, 7))+
  ggtitle("Colorimetric pH measurement (endpoint) \n") +
  # label
  # geom_text(aes(label = pH_colorimetric), size = 3, vjust = -1.5, family="serif", show.legend  = FALSE)+
  mytheme_2d

# plot - pH meter
# this is not endpoint, I added nitrate and water to the soil and shook and measured the supernatant.

ggplot(df_pH_meter, aes(x=pH, y=pH_meter, color=Soil, group=Soil)) +
  geom_point(size=4, shape=17, alpha=1) +
  # geom_line(size=1)+
  # scale_color_brewer(palette='Set1') +
  ylab("pH meter reads \n") +
  xlab("\n Intended pH (without pH buffer)") +
  # scale_y_continuous(breaks = seq(5,7,0.1), limits=c(5, 7))+
  ggtitle("pH meter measurement (after adding nitrate to soil) \n") +
  # label
  # geom_text(aes(label = pH_colorimetric), size = 3, vjust = -1.5, family="serif", show.legend  = FALSE)+
  mytheme_2d


# show difference of pH meter and colorimetric pH value
# join df
# df_pH_merge <- df_pH_color %>% left_join(df_pH_meter, by=c("Soil"="Soil", "pH"="pH")) %>% select(Soil, pH, pH_colorimetric, pH_meter)

df_pH_color2 <- df_pH_color %>% group_by(Soil, pH) %>% summarise(pH_colorimetric = mean(pH_colorimetric)) %>% ungroup() 
df_pH_color2 <- df_pH_color2 %>% rename(pH_read = pH_colorimetric) %>% mutate(Method = "colorimetric") 

df_pH_meter2 <- df_pH_meter %>% rename(pH_read = pH_meter) %>% mutate(Method = "pH_meter") %>% select(-Sample)

df_pH_merge <- rbind(df_pH_color2, df_pH_meter2)


ggplot(df_pH_merge, aes(x=pH, y=pH_read, color=Soil, shape=Method)) +
  geom_point(size=6, alpha=1) +
  # geom_line(size=1)+
  # scale_color_brewer(palette='Set1') +
  ylab("pH value \n") +
  xlab("\n Intended pH (without pH buffer)") +
  # scale_y_continuous(breaks = seq(5,7,0.1), limits=c(5, 7))+
  ggtitle("Colorimetric (endpoint) VS. pH meter (after adding nitrate to soil) \n") +
  # label
  # geom_text(aes(label = pH_colorimetric), size = 3, vjust = -1.5, family="serif", show.legend  = FALSE)+
  mytheme_2d


```


## Testing pH buffering capacity
Experimental date: 12/03/21 \
Analysis: 12/07/21 \

```{r}
df_nic <- openxlsx::read.xlsx("data/120321_soil_buffering_capacity_Nichols-B.xlsx")

ggplot(df_nic, aes(x=`0.1M_HCl_ul`, y=`Nichols-B`)) +
  geom_point(size=3, shape=16, alpha=1, color='navy') +
  geom_line(size=1, color='navy')+
  # scale_color_brewer(palette='Set1') +
  ylab("pH \n") +
  xlab("\n added 0.1M HCl (ul) to 17.25ml") +
  # scale_y_continuous(breaks = seq(5,7,0.1), limits=c(5, 7))+
  ggtitle("Soil buffering capacity (after adding nitrate to soil) \n") +
  # label
  # geom_text(aes(label = pH_colorimetric), size = 3, vjust = -1.5, family="serif", show.legend  = FALSE)+
  mytheme_2d

# convert x axis to mol
df_nic %<>% mutate(H_mol = `0.1M_HCl_ul` * 10^(-7))

ggplot(df_nic, aes(x=H_mol, y=`Nichols-B`)) +
  geom_point(size=3, shape=16, alpha=1, color='navy') +
  geom_line(size=1, color='navy')+
  # scale_color_brewer(palette='Set1') +
  ylab("pH \n") +
  xlab("\n added mol [H+] to 17.25ml") +
  scale_y_continuous(breaks = seq(0,9,1), limits=c(0, 9))+
  # scale_x_continuous(breaks = seq(0,7,0.1), limits=c(5, 7))+
  ggtitle("Soil buffering capacity (after adding nitrate to soil) \n") +
  # label
  # geom_text(aes(label = pH_colorimetric), size = 3, vjust = -1.5, family="serif", show.legend  = FALSE)+
  mytheme_2d

# convert x axis to mol
# 17.25ml
df_nic %<>% mutate(H_Molarity = H_mol / (17.25*0.001))
df_nic %<>% mutate(H_mM = H_Molarity * 1000)

ggplot(df_nic, aes(x=H_mM, y=`Nichols-B`)) +
  geom_point(size=3, shape=16, alpha=1, color='navy') +
  geom_line(size=1, color='navy')+
  # scale_color_brewer(palette='Set1') +
  ylab("pH \n") +
  xlab("\n added [H+] mM") +
  scale_y_continuous(breaks = seq(0,9,1), limits=c(0, 9))+
  # scale_x_continuous(breaks = seq(0,7,0.1), limits=c(5, 7))+
  ggtitle("Soil buffering capacity (after adding nitrate to soil) \n") +
  # label
  # geom_text(aes(label = pH_colorimetric), size = 3, vjust = -1.5, family="serif", show.legend  = FALSE)+
  mytheme_2d

# Washington-B sample
ggplot(df_nic, aes(x=`0.1M_HCl_ul`, y=`Washington-A`)) +
  geom_point(size=3, shape=16, alpha=1, color='navy') +
  geom_line(size=1, color='navy')+
  # scale_color_brewer(palette='Set1') +
  ylab("pH \n") +
  xlab("\n added 0.1M HCl (ul)") +
  # scale_y_continuous(breaks = seq(5,7,0.1), limits=c(5, 7))+
  ggtitle("Soil buffering capacity (Washington-A soil sample) \n") +
  # label
  # geom_text(aes(label = pH_colorimetric), size = 3, vjust = -1.5, family="serif", show.legend  = FALSE)+
  mytheme_2d


```


## Testing pH buffering capacity
Experimental date: 12/08/21 \
Analysis: 12/09/21 \

## 1. 1ul of 0.05M HCl or 0.05M NaOH was incrementally added
```{r}
df_pH_p1 <- openxlsx::read.xlsx("data/211208_pH_colorimetric_plate1.xlsx")
df_pH_p2 <- openxlsx::read.xlsx("data/211208_pH_colorimetric_plate2.xlsx")
df_pH_p3 <- openxlsx::read.xlsx("data/211208_pH_colorimetric_plate3.xlsx")
df_pH_p4 <- openxlsx::read.xlsx("data/211208_pH_colorimetric_T3.xlsx")
df_pH_p5 <- openxlsx::read.xlsx("data/211208_pH_colorimetric_T4.xlsx")
df_pH_p6 <- openxlsx::read.xlsx("data/211208_pH_colorimetric_T5.xlsx")

df_time <- openxlsx::read.xlsx("data/211208_time_table.xlsx")
df_time$Time_hours <- round(df_time$Time_hours, 1)
df_time$Time_days <- round(df_time$Time_days, 2)

# mols and molarity unit conversion
fun_df_convert <- function(df_pH_p1){
  df_pH_p1$Added_ul <- ifelse(df_pH_p1$Titration_type == "0.05M_NaOH",-1*df_pH_p1$Added_ul, df_pH_p1$Added_ul)
  df_pH_p1$Added_ul <- ifelse(df_pH_p1$Titration_type == "0.025M_NaOH",-1*df_pH_p1$Added_ul, df_pH_p1$Added_ul)
  df_pH_p1 %<>% mutate(H_mol = Concentration_M * Added_ul * 10^(-6))
  df_pH_p1 %<>% mutate(H_Molarity = H_mol / (300 * 10^(-6)))
  df_pH_p1 %<>% mutate(H_mM = H_Molarity * 1000)
  return(df_pH_p1)
}

df_pH_p1 <- fun_df_convert(df_pH_p1)
df_pH_p2 <- fun_df_convert(df_pH_p2)
df_pH_p3 <- fun_df_convert(df_pH_p3)
df_pH_p4 <- fun_df_convert(df_pH_p4)
df_pH_p5 <- fun_df_convert(df_pH_p5)
df_pH_p6 <- fun_df_convert(df_pH_p6)

colnames(df_pH_p1)
colnames(df_pH_p2)
colnames(df_pH_p3)
colnames(df_pH_p4)
colnames(df_pH_p5)
colnames(df_pH_p6)

df_pH_p <- rbind(df_pH_p1, df_pH_p2, df_pH_p3, df_pH_p4, df_pH_p5, df_pH_p6)
df_pH_p %<>% left_join(df_time, by=c("Time_point"="Time_point"))
df_pH_0.05 <- df_pH_p %>% filter(Concentration_M == 0.05)
df_pH_0.025 <- df_pH_p %>% filter(Concentration_M == 0.025)


# 1. (40min) 1ul of 0.05M HCl or 0.05M NaOH was incrementally added
df_0.05 <- df_pH_p1 %>% filter(Concentration_M == 0.05)

# plot 0.05M HCl, NaOH
ggplot(df_0.05, aes(x=Added_ul, y=pH_colorimetric)) +
  geom_point(size=3, shape=16, alpha=1, color='navy') +
  geom_line(size=1, color='navy')+
  # scale_color_brewer(palette='Set1') +
  ylab("pH \n") +
  xlab("\n added 0.05M HCl/NaOH (ul) to 300ul") +
  scale_y_continuous(breaks = seq(0,12,1), limits=c(0, 12))+
  ggtitle("Soil titration curve with 0.05M HCl/NaOH (Nichols-B filtered supernatant) \n") +
  # label
  # geom_text(aes(label = pH_colorimetric), size = 3, vjust = -1.5, family="serif", show.legend  = FALSE)+
  mytheme_2d

# mol
ggplot(df_0.05, aes(x=H_mM, y=pH_colorimetric)) +
  geom_point(size=3, shape=16, alpha=1, color='navy') +
  geom_line(size=1, color='navy')+
  # scale_color_brewer(palette='Set1') +
  ylab("pH \n") +
  xlab("\n added [H+] mM") +
  scale_y_continuous(breaks = seq(0,12,1), limits=c(0, 12))+
  ggtitle("Soil titration curve with 0.05M HCl/NaOH (Nichols-B filtered supernatant) \n") +
  # label
  # geom_text(aes(label = pH_colorimetric), size = 3, vjust = -1.5, family="serif", show.legend  = FALSE)+
  mytheme_2d


# 2. (11hr overnight measurement after adding dye) 1ul of 0.05M HCl or 0.05M NaOH was incrementally added
df_0.05 <- df_pH_p2 %>% filter(Concentration_M == 0.05)

# plot 0.05M HCl, NaOH
ggplot(df_0.05, aes(x=Added_ul, y=pH_colorimetric)) +
  geom_point(size=3, shape=16, alpha=1, color='navy') +
  geom_line(size=1, color='navy')+
  # scale_color_brewer(palette='Set1') +
  ylab("pH \n") +
  xlab("\n added 0.05M HCl/NaOH (ul) to 300ul") +
  scale_y_continuous(breaks = seq(0,12,1), limits=c(0, 12))+
  ggtitle("[Overnight] Soil titration curve with 0.05M HCl/NaOH (Nichols-B filtered supernatant) \n") +
  # label
  # geom_text(aes(label = pH_colorimetric), size = 3, vjust = -1.5, family="serif", show.legend  = FALSE)+
  mytheme_2d

# mol
ggplot(df_0.05, aes(x=H_mM, y=pH_colorimetric)) +
  geom_point(size=3, shape=16, alpha=1, color='navy') +
  geom_line(size=1, color='navy')+
  # scale_color_brewer(palette='Set1') +
  ylab("pH \n") +
  xlab("\n added [H+] mM") +
  scale_y_continuous(breaks = seq(0,12,1), limits=c(0, 12))+
  ggtitle("[Overnight] Soil titration curve with 0.05M HCl/NaOH (Nichols-B filtered supernatant) \n") +
  # label
  # geom_text(aes(label = pH_colorimetric), size = 3, vjust = -1.5, family="serif", show.legend  = FALSE)+
  mytheme_2d

# 3. (37hr overnight measurement after adding dye) 1ul of 0.05M HCl or 0.05M NaOH was incrementally added
df_0.05 <- df_pH_p3 %>% filter(Concentration_M == 0.05)

# plot 0.05M HCl, NaOH
ggplot(df_0.05, aes(x=Added_ul, y=pH_colorimetric)) +
  geom_point(size=3, shape=16, alpha=1, color='navy') +
  geom_line(size=1, color='navy')+
  # scale_color_brewer(palette='Set1') +
  ylab("pH \n") +
  xlab("\n added 0.05M HCl/NaOH (ul) to 300ul") +
  scale_y_continuous(breaks = seq(0,12,1), limits=c(0, 12))+
  ggtitle("[37hr] Soil titration curve with 0.05M HCl/NaOH (Nichols-B filtered supernatant) \n") +
  # label
  # geom_text(aes(label = pH_colorimetric), size = 3, vjust = -1.5, family="serif", show.legend  = FALSE)+
  mytheme_2d

# mol
ggplot(df_0.05, aes(x=H_mM, y=pH_colorimetric)) +
  geom_point(size=3, shape=16, alpha=1, color='navy') +
  geom_line(size=1, color='navy')+
  # scale_color_brewer(palette='Set1') +
  ylab("pH \n") +
  xlab("\n added [H+] mM") +
  scale_y_continuous(breaks = seq(0,12,1), limits=c(0, 12))+
  ggtitle("[37hr] Soil titration curve with 0.05M HCl/NaOH (Nichols-B filtered supernatant) \n") +
  # label
  # geom_text(aes(label = pH_colorimetric), size = 3, vjust = -1.5, family="serif", show.legend  = FALSE)+
  mytheme_2d


# 4. (T3) 1ul of 0.05M HCl or 0.05M NaOH was incrementally added
df_0.05 <- df_pH_p4 %>% filter(Concentration_M == 0.05)
# mol
ggplot(df_0.05, aes(x=H_mM, y=pH_colorimetric)) +
  geom_point(size=3, shape=16, alpha=1, color='navy') +
  geom_line(size=1, color='navy')+
  # scale_color_brewer(palette='Set1') +
  ylab("pH \n") +
  xlab("\n added [H+] mM") +
  scale_y_continuous(breaks = seq(0,12,1), limits=c(0, 12))+
  ggtitle("[61hr] Soil titration curve with 0.05M HCl/NaOH (Nichols-B filtered supernatant) \n") +
  # label
  # geom_text(aes(label = pH_colorimetric), size = 3, vjust = -1.5, family="serif", show.legend  = FALSE)+
  mytheme_2d

# 5. (T4) 1ul of 0.05M HCl or 0.05M NaOH was incrementally added
df_0.05 <- df_pH_p5 %>% filter(Concentration_M == 0.05)
# mol
ggplot(df_0.05, aes(x=H_mM, y=pH_colorimetric)) +
  geom_point(size=3, shape=16, alpha=1, color='navy') +
  geom_line(size=1, color='navy')+
  # scale_color_brewer(palette='Set1') +
  ylab("pH \n") +
  xlab("\n added [H+] mM") +
  scale_y_continuous(breaks = seq(0,12,1), limits=c(0, 12))+
  ggtitle("[84hr] Soil titration curve with 0.05M HCl/NaOH (Nichols-B filtered supernatant) \n") +
  # label
  # geom_text(aes(label = pH_colorimetric), size = 3, vjust = -1.5, family="serif", show.legend  = FALSE)+
  mytheme_2d

# 6. (T5) 1ul of 0.05M HCl or 0.05M NaOH was incrementally added
df_0.05 <- df_pH_p6 %>% filter(Concentration_M == 0.05)
# mol
ggplot(df_0.05, aes(x=H_mM, y=pH_colorimetric)) +
  geom_point(size=3, shape=16, alpha=1, color='navy') +
  geom_line(size=1, color='navy')+
  # scale_color_brewer(palette='Set1') +
  ylab("pH \n") +
  xlab("\n added [H+] mM") +
  scale_y_continuous(breaks = seq(0,12,1), limits=c(0, 12))+
  ggtitle("[155hr] Soil titration curve with 0.05M HCl/NaOH (Nichols-B filtered supernatant) \n") +
  # label
  # geom_text(aes(label = pH_colorimetric), size = 3, vjust = -1.5, family="serif", show.legend  = FALSE)+
  mytheme_2d

# Draw all at once
# mol
df_pH_0.05$Time_hours <- factor(df_pH_0.05$Time_hours)
df_pH_0.05$Time_days <- factor(df_pH_0.05$Time_days)

ggplot(df_pH_0.05, aes(x=H_mM, y=pH_colorimetric, color=Time_hours, group=Time_hours)) +
  geom_point(size=3, shape=16, alpha=1) +
  geom_line(size=1)+
  # scale_color_brewer(palette='Set1') +
  ylab("pH \n") +
  xlab("\n added [H+] mM") +
  scale_y_continuous(breaks = seq(0,12,1), limits=c(0, 12))+
  ggtitle("Soil titration curve with 0.05M HCl/NaOH (Nichols-B filtered supernatant) \n") +
  # label
  # geom_text(aes(label = pH_colorimetric), size = 3, vjust = -1.5, family="serif", show.legend  = FALSE)+
  mytheme_2d


ggplot(df_pH_0.05, aes(x=H_mM, y=pH_colorimetric, color=Time_days, group=Time_days)) +
  geom_point(size=3, shape=16, alpha=1) +
  geom_line(size=1)+
  # scale_color_brewer(palette='Set1') +
  ylab("pH \n") +
  xlab("\n added [H+] mM") +
  scale_y_continuous(breaks = seq(0,12,1), limits=c(0, 12))+
  ggtitle("Soil titration curve with 0.05M HCl/NaOH (Nichols-B filtered supernatant) \n") +
  # label
  # geom_text(aes(label = pH_colorimetric), size = 3, vjust = -1.5, family="serif", show.legend  = FALSE)+
  mytheme_2d

```


## 2. 1ul of 0.025M HCl or 0.025M NaOH was incrementally added
```{r}
# 2. (40min) 1ul of 0.025M HCl or 0.025M NaOH was incrementally added
df_0.025 <- df_pH_p1 %>% filter(Concentration_M == 0.025)

# plot 0.025M HCl, NaOH
ggplot(df_0.025, aes(x=Added_ul, y=pH_colorimetric)) +
  geom_point(size=3, shape=16, alpha=1, color='navy') +
  geom_line(size=1, color='navy')+
  # scale_color_brewer(palette='Set1') +
  ylab("pH \n") +
  xlab("\n added 0.025M HCl/NaOH (ul) to 300ul") +
  scale_y_continuous(breaks = seq(0,12,1), limits=c(0, 12))+
  ggtitle("Soil titration curve with 0.025M HCl/NaOH (Nichols-B filtered supernatant) \n") +
  # label
  # geom_text(aes(label = pH_colorimetric), size = 3, vjust = -1.5, family="serif", show.legend  = FALSE)+
  mytheme_2d

# mol
ggplot(df_0.025, aes(x=H_mM, y=pH_colorimetric)) +
  geom_point(size=3, shape=16, alpha=1, color='navy') +
  geom_line(size=1, color='navy')+
  # scale_color_brewer(palette='Set1') +
  ylab("pH \n") +
  xlab("\n added [H+] mM") +
  scale_y_continuous(breaks = seq(0,12,1), limits=c(0, 12))+
  ggtitle("Soil titration curve with 0.025M HCl/NaOH (Nichols-B filtered supernatant) \n") +
  # label
  # geom_text(aes(label = pH_colorimetric), size = 3, vjust = -1.5, family="serif", show.legend  = FALSE)+
  mytheme_2d


# 2. (11hr overnight measurement after adding dye) 1ul of 0.025M HCl or 0.025M NaOH was incrementally added
df_0.025 <- df_pH_p2 %>% filter(Concentration_M == 0.025)

# plot 0.025M HCl, NaOH
ggplot(df_0.025, aes(x=Added_ul, y=pH_colorimetric)) +
  geom_point(size=3, shape=16, alpha=1, color='navy') +
  geom_line(size=1, color='navy')+
  # scale_color_brewer(palette='Set1') +
  ylab("pH \n") +
  xlab("\n added 0.025M HCl/NaOH (ul) to 300ul") +
  scale_y_continuous(breaks = seq(0,12,1), limits=c(0, 12))+
  ggtitle("[Overnight] Soil titration curve with 0.025M HCl/NaOH (Nichols-B filtered supernatant) \n") +
  # label
  # geom_text(aes(label = pH_colorimetric), size = 3, vjust = -1.5, family="serif", show.legend  = FALSE)+
  mytheme_2d

# mol
ggplot(df_0.025, aes(x=H_mM, y=pH_colorimetric)) +
  geom_point(size=3, shape=16, alpha=1, color='navy') +
  geom_line(size=1, color='navy')+
  # scale_color_brewer(palette='Set1') +
  ylab("pH \n") +
  xlab("\n added [H+] mM") +
  scale_y_continuous(breaks = seq(0,12,1), limits=c(0, 12))+
  ggtitle("[Overnight] Soil titration curve with 0.025M HCl/NaOH (Nichols-B filtered supernatant) \n") +
  # label
  # geom_text(aes(label = pH_colorimetric), size = 3, vjust = -1.5, family="serif", show.legend  = FALSE)+
  mytheme_2d

# 3. (37hr overnight measurement after adding dye) 1ul of 0.025M HCl or 0.025M NaOH was incrementally added
df_0.025 <- df_pH_p3 %>% filter(Concentration_M == 0.025)

# plot 0.025M HCl, NaOH
ggplot(df_0.025, aes(x=Added_ul, y=pH_colorimetric)) +
  geom_point(size=3, shape=16, alpha=1, color='navy') +
  geom_line(size=1, color='navy')+
  # scale_color_brewer(palette='Set1') +
  ylab("pH \n") +
  xlab("\n added 0.025M HCl/NaOH (ul) to 300ul") +
  scale_y_continuous(breaks = seq(0,12,1), limits=c(0, 12))+
  ggtitle("[37hr] Soil titration curve with 0.025M HCl/NaOH (Nichols-B filtered supernatant) \n") +
  # label
  # geom_text(aes(label = pH_colorimetric), size = 3, vjust = -1.5, family="serif", show.legend  = FALSE)+
  mytheme_2d

# mol
ggplot(df_0.025, aes(x=H_mM, y=pH_colorimetric)) +
  geom_point(size=3, shape=16, alpha=1, color='navy') +
  geom_line(size=1, color='navy')+
  # scale_color_brewer(palette='Set1') +
  ylab("pH \n") +
  xlab("\n added [H+] mM") +
  scale_y_continuous(breaks = seq(0,12,1), limits=c(0, 12))+
  ggtitle("[37hr] Soil titration curve with 0.025M HCl/NaOH (Nichols-B filtered supernatant) \n") +
  # label
  # geom_text(aes(label = pH_colorimetric), size = 3, vjust = -1.5, family="serif", show.legend  = FALSE)+
  mytheme_2d

# Draw all at once
# mol
df_pH_0.025$Time_hours <- factor(df_pH_0.025$Time_hours)
df_pH_0.025$Time_days <- factor(df_pH_0.025$Time_days)

ggplot(df_pH_0.025, aes(x=H_mM, y=pH_colorimetric, color=Time_hours, group=Time_hours)) +
  geom_point(size=3, shape=16, alpha=1) +
  geom_line(size=1)+
  # scale_color_brewer(palette='Set1') +
  ylab("pH \n") +
  xlab("\n added [H+] mM") +
  scale_y_continuous(breaks = seq(0,12,1), limits=c(0, 12))+
  ggtitle("Soil titration curve with 0.025M HCl/NaOH (Nichols-B filtered supernatant) \n") +
  # label
  # geom_text(aes(label = pH_colorimetric), size = 3, vjust = -1.5, family="serif", show.legend  = FALSE)+
  mytheme_2d


ggplot(df_pH_0.025, aes(x=H_mM, y=pH_colorimetric, color=Time_days, group=Time_days)) +
  geom_point(size=3, shape=16, alpha=1) +
  geom_line(size=1)+
  # scale_color_brewer(palette='Set1') +
  ylab("pH \n") +
  xlab("\n added [H+] mM") +
  scale_y_continuous(breaks = seq(0,12,1), limits=c(0, 12))+
  ggtitle("Soil titration curve with 0.025M HCl/NaOH (Nichols-B filtered supernatant) \n") +
  # label
  # geom_text(aes(label = pH_colorimetric), size = 3, vjust = -1.5, family="serif", show.legend  = FALSE)+
  mytheme_2d

```



## Testing pH buffering capacity
Experimental date: 12/10/21 \
Analysis: 12/16/21 \

## 1. 1ul of 0.05M HCl or 0.05M NaOH was incrementally added
```{r}
df_pH_t0 <- openxlsx::read.xlsx("data/211210_pH_colorimetric_T0.xlsx")
df_pH_t1 <- openxlsx::read.xlsx("data/211210_pH_colorimetric_T1.xlsx")
df_pH_t2 <- openxlsx::read.xlsx("data/211210_pH_colorimetric_T2.xlsx")
df_pH_t3 <- openxlsx::read.xlsx("data/211210_pH_colorimetric_T3.xlsx")
dim(df_pH_t0)
dim(df_pH_t1)
dim(df_pH_t2)
dim(df_pH_t3)

df_time <- openxlsx::read.xlsx("data/211210_time_table.xlsx")
df_time$Time_hours <- round(df_time$Time_hours, 1)
df_time$Time_days <- round(df_time$Time_days, 2)

# mols and molarity unit conversion
fun_df_convert <- function(df_pH_p1){
  df_pH_p1$Added_ul <- ifelse(df_pH_p1$Titration_type == "0.05M_NaOH",-1*df_pH_p1$Added_ul, df_pH_p1$Added_ul)
  df_pH_p1$Added_ul <- ifelse(df_pH_p1$Titration_type == "0.025M_NaOH",-1*df_pH_p1$Added_ul, df_pH_p1$Added_ul)
  df_pH_p1 %<>% mutate(H_mol = Concentration_M * Added_ul * 10^(-6))
  df_pH_p1 %<>% mutate(H_Molarity = H_mol / (300 * 10^(-6)))
  df_pH_p1 %<>% mutate(H_mM = H_Molarity * 1000)
  return(df_pH_p1)
}

df_pH_t0 <- fun_df_convert(df_pH_t0)
df_pH_t1 <- fun_df_convert(df_pH_t1)
df_pH_t2 <- fun_df_convert(df_pH_t2)
df_pH_t3 <- fun_df_convert(df_pH_t3)

colnames(df_pH_t0)
colnames(df_pH_t1)
colnames(df_pH_t2)
colnames(df_pH_t3)


df_pH_t <- rbind(df_pH_t0, df_pH_t1, df_pH_t2, df_pH_t3)
df_pH_t %<>% left_join(df_time, by=c("Time_point"="Time_point"))


# 1. (40min) 1ul of 0.05M HCl or 0.05M NaOH was incrementally added
df_T3 <- df_pH_t %>% filter(Time_point == "T3")

# plot 0.05M HCl, NaOH
ggplot(df_T3, aes(x=Added_ul, y=pH_colorimetric)) +
  geom_point(size=3, shape=16, alpha=1, color='navy') +
  geom_line(size=1, color='navy')+
  # scale_color_brewer(palette='Set1') +
  ylab("pH \n") +
  xlab("\n added 0.05M HCl/NaOH (ul) to 300ul") +
  scale_y_continuous(breaks = seq(0,12,1), limits=c(0, 12))+
  ggtitle("[Day5] Soil titration curve with 0.05M HCl/NaOH (Allandale3(pH3.97) filtered supernatant) \n") +
  # label
  # geom_text(aes(label = pH_colorimetric), size = 3, vjust = -1.5, family="serif", show.legend  = FALSE)+
  mytheme_2d

# mol
ggplot(df_T3, aes(x=H_mM, y=pH_colorimetric)) +
  geom_point(size=3, shape=16, alpha=1, color='navy') +
  geom_line(size=1, color='navy')+
  # scale_color_brewer(palette='Set1') +
  ylab("pH \n") +
  xlab("\n added [H+] mM") +
  scale_y_continuous(breaks = seq(0,12,1), limits=c(0, 12))+
  ggtitle("[Day5] Soil titration curve with 0.05M HCl/NaOH (Allandale3(pH3.97) filtered supernatant) \n") +
  # label
  # geom_text(aes(label = pH_colorimetric), size = 3, vjust = -1.5, family="serif", show.legend  = FALSE)+
  mytheme_2d


# Draw all at once
# mol
df_pH_t$Time_hours <- factor(df_pH_t$Time_hours)
df_pH_t$Time_days <- factor(df_pH_t$Time_days)

ggplot(df_pH_t, aes(x=H_mM, y=pH_colorimetric, color=Time_hours, group=Time_hours)) +
  geom_point(size=3, shape=16, alpha=1) +
  geom_line(size=1)+
  # scale_color_brewer(palette='Set1') +
  ylab("pH \n") +
  xlab("\n added [H+] mM") +
  scale_y_continuous(breaks = seq(0,12,1), limits=c(0, 12))+
  ggtitle("Soil titration curve with 0.05M HCl/NaOH (Allandale3(pH3.97) filtered supernatant) \n") +
  # label
  # geom_text(aes(label = pH_colorimetric), size = 3, vjust = -1.5, family="serif", show.legend  = FALSE)+
  mytheme_2d

ggplot(df_pH_t, aes(x=H_mM, y=pH_colorimetric, color=Time_days, group=Time_days)) +
  geom_point(size=3, shape=16, alpha=1) +
  geom_line(size=1)+
  # scale_color_brewer(palette='Set1') +
  ylab("pH \n") +
  xlab("\n added [H+] mM") +
  scale_y_continuous(breaks = seq(0,12,1), limits=c(0, 12))+
  ggtitle("Soil titration curve with 0.05M HCl/NaOH (Allandale3(pH3.97) filtered supernatant) \n") +
  # label
  # geom_text(aes(label = pH_colorimetric), size = 3, vjust = -1.5, family="serif", show.legend  = FALSE)+
  mytheme_2d

```

## 2. Compare the two soil titration curves.
- I'll compare 1.5day samples & 0.05M HCl/NaOH added ones.
```{r}
df_Nichols_1.5 <- df_pH_0.05 %>% filter(Time_days == 1.50) %>% mutate(Soil_type = "Neutral(pH 7.29)")
df_Allan_1.5 <- df_pH_t %>% filter(Time_days == 1.64) %>% mutate(Soil_type = "Acidic(pH 3.97)")

df_pH_merged <- rbind(df_Nichols_1.5, df_Allan_1.5)

ggplot(df_pH_merged, aes(x=H_mM, y=pH_colorimetric, color=Soil_type, group=Soil_type)) +
  geom_point(size=3, shape=16, alpha=1) +
  geom_line(size=1)+
  # scale_color_brewer(palette='Set1') +
  ylab("pH \n") +
  xlab("\n added [H+] mM") +
  scale_y_continuous(breaks = seq(0,12,1), limits=c(0, 12))+
  ggtitle("Soil titration curve comparison (1.5 days after adding acid/base) \n") +
  # label
  # geom_text(aes(label = pH_colorimetric), size = 3, vjust = -1.5, family="serif", show.legend  = FALSE)+
  mytheme_2d

# shift left
plot_shifted <- function(df_Nichols_1.5, df_Allan_1.5, num_shift = 1){
  df_NicholsB_shifted <- df_Nichols_1.5 %>% mutate(H_mM = H_mM - num_shift)
  df_pH_merged <- rbind(df_NicholsB_shifted, df_Allan_1.5)
  p1 <- ggplot(df_pH_merged, aes(x=H_mM, y=pH_colorimetric, color=Soil_type, group=Soil_type)) +
    geom_point(size=3, shape=16, alpha=1) +
    geom_line(size=1)+
    # scale_color_brewer(palette='Set1') +
    ylab("pH \n") +
    xlab("\n added [H+] mM") +
    scale_y_continuous(breaks = seq(0,12,1), limits=c(0, 12))+
    ggtitle("Soil titration curve [After Neutral Shifted] comparison (1.5 days after adding acid/base) \n") +
    # label
    # geom_text(aes(label = pH_colorimetric), size = 3, vjust = -1.5, family="serif", show.legend  = FALSE)+
    mytheme_2d
  return(p1)
}

plot_shifted(df_Nichols_1.5, df_Allan_1.5, num_shift = 0.8)


# plot the day 4 (3.5 & 4.6 day)

df_Nichols_T4 <- df_pH_0.05 %>% filter(Time_point == "T4") %>% mutate(Soil_type = "Neutral(pH 7.29)")
df_Allan_T3 <- df_pH_t %>% filter(Time_point == "T3") %>% mutate(Soil_type = "Acidic(pH 3.97)")

plot_shifted <- function(df_Nichols_1.5, df_Allan_1.5, num_shift = 1){
  df_NicholsB_shifted <- df_Nichols_1.5 %>% mutate(H_mM = H_mM - num_shift)
  df_pH_merged <- rbind(df_NicholsB_shifted, df_Allan_1.5)
  p1 <- ggplot(df_pH_merged, aes(x=H_mM, y=pH_colorimetric, color=Soil_type, group=Soil_type)) +
    geom_point(size=3, shape=16, alpha=1) +
    geom_line(size=1)+
    # scale_color_brewer(palette='Set1') +
    ylab("pH \n") +
    xlab("\n added [H+] mM") +
    scale_y_continuous(breaks = seq(0,12,1), limits=c(0, 12))+
    ggtitle("Soil titration curve [After Neutral curve Shifted] comparison (3-5 days after adding acid/base) \n") +
    # label
    # geom_text(aes(label = pH_colorimetric), size = 3, vjust = -1.5, family="serif", show.legend  = FALSE)+
    mytheme_2d
  return(p1)
}

plot_shifted(df_Nichols_T4, df_Allan_T3, num_shift = 1.1)



```


## Testing pH buffering capacity
Experimental date: 12/18/21 - 5 or 7 days \
Analysis: 12/21/21 \

## 1. 1ul of 0.05M HCl or 0.05M NaOH was incrementally added
```{r}
df_pH_t0 <- openxlsx::read.xlsx("data/211218_pH_colorimetric_t0.xlsx")
df_pH_t1 <- openxlsx::read.xlsx("data/211218_pH_colorimetric_t1.xlsx")
df_pH_t2 <- openxlsx::read.xlsx("data/211218_pH_colorimetric_t2.xlsx")
df_pH_t3 <- openxlsx::read.xlsx("data/211218_pH_colorimetric_t3.xlsx")
df_pH_t4 <- openxlsx::read.xlsx("data/211218_pH_colorimetric_t4.xlsx")

dim(df_pH_t0)
dim(df_pH_t1)
dim(df_pH_t2)
dim(df_pH_t3)
dim(df_pH_t4)

df_time <- openxlsx::read.xlsx("data/211218_time_table.xlsx")
df_time$Time_hours <- round(df_time$Time_hours, 1)
df_time$Time_days <- round(df_time$Time_days, 2)

# mols and molarity unit conversion
fun_df_convert <- function(df_pH_p1){
  df_pH_p1$Added_ul <- ifelse(df_pH_p1$Titration_type == "0.05M_NaOH",-1*df_pH_p1$Added_ul, df_pH_p1$Added_ul)
  df_pH_p1$Added_ul <- ifelse(df_pH_p1$Titration_type == "0.025M_NaOH",-1*df_pH_p1$Added_ul, df_pH_p1$Added_ul)
  df_pH_p1 %<>% mutate(H_mol = Concentration_M * Added_ul * 10^(-6))
  df_pH_p1 %<>% mutate(H_Molarity = H_mol / (300 * 10^(-6)))
  df_pH_p1 %<>% mutate(H_mM = H_Molarity * 1000)
  return(df_pH_p1)
}

df_pH_t0 <- fun_df_convert(df_pH_t0)
df_pH_t1 <- fun_df_convert(df_pH_t1)
df_pH_t2 <- fun_df_convert(df_pH_t2)
df_pH_t3 <- fun_df_convert(df_pH_t3)
df_pH_t4 <- fun_df_convert(df_pH_t4)

colnames(df_pH_t0)
colnames(df_pH_t1)
colnames(df_pH_t2)
colnames(df_pH_t3)
colnames(df_pH_t4)


df_pH_t <- rbind(df_pH_t0, df_pH_t1, df_pH_t2, df_pH_t3, df_pH_t4)
df_pH_t %<>% left_join(df_time, by=c("Time_point"="Time_point"))

# 1 time point # mol
df_T0 <- df_pH_t %>% filter(Time_point == "T0")

ggplot(df_T0, aes(x=H_mM, y=pH_colorimetric, color=Method, group=Method)) +
  geom_point(size=3, shape=16, alpha=1) +
  geom_line(size=1)+
  # scale_color_brewer(palette='Set1') +
  ylab("pH \n") +
  xlab("\n added [H+] mM") +
  scale_y_continuous(breaks = seq(0,12,1), limits=c(0, 12))+
  ggtitle("[Day0] Soil titration curve with 0.05M HCl/NaOH (NicholsB(pH7.29) filtered supernatant) \n") +
  # label
  # geom_text(aes(label = pH_colorimetric), size = 3, vjust = -1.5, family="serif", show.legend  = FALSE)+
  mytheme_2d

df_T1 <- df_pH_t %>% filter(Time_point == "T1")

ggplot(df_T1, aes(x=H_mM, y=pH_colorimetric, color=Method, group=Method)) +
  geom_point(size=3, shape=16, alpha=1) +
  geom_line(size=1)+
  # scale_color_brewer(palette='Set1') +
  ylab("pH \n") +
  xlab("\n added [H+] mM") +
  scale_y_continuous(breaks = seq(0,12,1), limits=c(0, 12))+
  ggtitle("[Day1] Soil titration curve with 0.05M HCl/NaOH (NicholsB(pH7.29) filtered supernatant) \n") +
  # label
  # geom_text(aes(label = pH_colorimetric), size = 3, vjust = -1.5, family="serif", show.legend  = FALSE)+
  mytheme_2d

df_T2 <- df_pH_t %>% filter(Time_point == "T2")

ggplot(df_T2, aes(x=H_mM, y=pH_colorimetric, color=Method, group=Method)) +
  geom_point(size=3, shape=16, alpha=1) +
  geom_line(size=1)+
  # scale_color_brewer(palette='Set1') +
  ylab("pH \n") +
  xlab("\n added [H+] mM") +
  scale_y_continuous(breaks = seq(0,12,1), limits=c(0, 12))+
  ggtitle("[Day2] Soil titration curve with 0.05M HCl/NaOH (NicholsB(pH7.29) filtered supernatant) \n") +
  # label
  # geom_text(aes(label = pH_colorimetric), size = 3, vjust = -1.5, family="serif", show.legend  = FALSE)+
  mytheme_2d

df_T3 <- df_pH_t %>% filter(Time_point == "T3")

ggplot(df_T3, aes(x=H_mM, y=pH_colorimetric, color=Method, group=Method)) +
  geom_point(size=3, shape=16, alpha=1) +
  geom_line(size=1)+
  # scale_color_brewer(palette='Set1') +
  ylab("pH \n") +
  xlab("\n added [H+] mM") +
  scale_y_continuous(breaks = seq(0,12,1), limits=c(0, 12))+
  ggtitle("[Day3] Soil titration curve with 0.05M HCl/NaOH (NicholsB(pH7.29) filtered supernatant) \n") +
  # label
  # geom_text(aes(label = pH_colorimetric), size = 3, vjust = -1.5, family="serif", show.legend  = FALSE)+
  mytheme_2d

df_T4 <- df_pH_t %>% filter(Time_point == "T4")

ggplot(df_T4, aes(x=H_mM, y=pH_colorimetric, color=Method, group=Method)) +
  geom_point(size=3, shape=16, alpha=1) +
  geom_line(size=1)+
  # scale_color_brewer(palette='Set1') +
  ylab("pH \n") +
  xlab("\n added [H+] mM") +
  scale_y_continuous(breaks = seq(0,12,1), limits=c(0, 12))+
  ggtitle("[Day4] Soil titration curve with 0.05M HCl/NaOH (NicholsB(pH7.29) filtered supernatant) \n") +
  # label
  # geom_text(aes(label = pH_colorimetric), size = 3, vjust = -1.5, family="serif", show.legend  = FALSE)+
  mytheme_2d
df_T4 <- df_pH_t %>% filter(Time_point == "T4")

ggplot(df_T4, aes(x=H_mM, y=pH_colorimetric, color=Method, group=Method)) +
  geom_point(size=3, shape=16, alpha=1) +
  geom_line(size=1)+
  # scale_color_brewer(palette='Set1') +
  ylab("pH \n") +
  xlab("\n added [H+] mM") +
  scale_y_continuous(breaks = seq(0,12,1), limits=c(0, 12))+
  ggtitle("[Day4] Soil titration curve with 0.05M HCl/NaOH (NicholsB(pH7.29) filtered supernatant) \n") +
  # label
  # geom_text(aes(label = pH_colorimetric), size = 3, vjust = -1.5, family="serif", show.legend  = FALSE)+
  mytheme_2d

# Time points in grid
ggplot(df_pH_t, aes(x=H_mM, y=pH_colorimetric, color=Method, group=Method)) +
  geom_point(size=3, shape=16, alpha=1) +
  geom_line(size=1)+
  # scale_color_brewer(palette='Set1') +
  ylab("pH \n") +
  xlab("\n added [H+] mM") +
  scale_y_continuous(breaks = seq(0,12,1), limits=c(0, 12))+
  ggtitle("[At day n] Soil titration curve with 0.05M HCl/NaOH (NicholsB(pH7.29) filtered supernatant) \n") +
  # label
  # geom_text(aes(label = pH_colorimetric), size = 3, vjust = -1.5, family="serif", show.legend  = FALSE)+
  mytheme_2d +
  facet_wrap(Time_days ~ . , nrow=2) +
  theme(strip.background = element_rect(colour="black", fill="white", size=0.1))

# 3 time points
df_pH_tp <- df_pH_t %>% filter(Time_point %in% c("T0","T2","T4")) 
ggplot(df_pH_tp, aes(x=H_mM, y=pH_colorimetric, color=Method, group=Method)) +
  geom_point(size=3, shape=16, alpha=1) +
  geom_line(size=1)+
  # scale_color_brewer(palette='Set1') +
  ylab("pH \n") +
  xlab("\n added [H+] mM") +
  scale_y_continuous(breaks = seq(0,12,1), limits=c(0, 12))+
  ggtitle("[At day n] Soil titration curve with 0.05M HCl/NaOH (NicholsB(pH7.29) filtered supernatant) \n") +
  # label
  # geom_text(aes(label = pH_colorimetric), size = 3, vjust = -1.5, family="serif", show.legend  = FALSE)+
  mytheme_2d +
  facet_grid(Time_days ~ .) +
  theme(strip.background = element_rect(colour="black", fill="white", size=0.1))


# Draw single method & time series
df_pH_t$Time_hours <- factor(df_pH_t$Time_hours)
df_pH_t$Time_days <- factor(df_pH_t$Time_days)

# 2mM NO3 1:2 method
df_pH_2mMNO3 <- df_pH_t %>% filter(Method == "2mM_NO3_1_2")

ggplot(df_pH_2mMNO3, aes(x=H_mM, y=pH_colorimetric, color=Time_days, group=Time_days)) +
  geom_point(size=3, shape=16, alpha=1) +
  geom_line(size=1)+
  # scale_color_brewer(palette='Set1') +
  ylab("pH \n") +
  xlab("\n added [H+] mM") +
  scale_y_continuous(breaks = seq(0,12,1), limits=c(0, 12))+
  ggtitle("[Soil:2mM NO3 = 1:2 method] Soil titration curve with 0.05M HCl/NaOH (NicholsB (pH7.29) filtered supernatant) \n") +
  # label
  # geom_text(aes(label = pH_colorimetric), size = 3, vjust = -1.5, family="serif", show.legend  = FALSE)+
  mytheme_2d

# Soil:H2O = 1:2 method
df_pH_H2O2 <- df_pH_t %>% filter(Method == "H2O_1_2")

ggplot(df_pH_H2O2, aes(x=H_mM, y=pH_colorimetric, color=Time_days, group=Time_days)) +
  geom_point(size=3, shape=16, alpha=1) +
  geom_line(size=1)+
  # scale_color_brewer(palette='Set1') +
  ylab("pH \n") +
  xlab("\n added [H+] mM") +
  scale_y_continuous(breaks = seq(0,12,1), limits=c(0, 12))+
  ggtitle("[Soil:H2O = 1:2 method] Soil titration curve with 0.05M HCl/NaOH (NicholsB (pH7.29) filtered supernatant) \n") +
  # label
  # geom_text(aes(label = pH_colorimetric), size = 3, vjust = -1.5, family="serif", show.legend  = FALSE)+
  mytheme_2d

# Soil:H2O = 1:5 method
df_pH_H2O5 <- df_pH_t %>% filter(Method == "H2O_1_5")

ggplot(df_pH_H2O5, aes(x=H_mM, y=pH_colorimetric, color=Time_days, group=Time_days)) +
  geom_point(size=3, shape=16, alpha=1) +
  geom_line(size=1)+
  # scale_color_brewer(palette='Set1') +
  ylab("pH \n") +
  xlab("\n added [H+] mM") +
  scale_y_continuous(breaks = seq(0,12,1), limits=c(0, 12))+
  ggtitle("[Soil:H2O = 1:5 method] Soil titration curve with 0.05M HCl/NaOH (NicholsB (pH7.29) filtered supernatant) \n") +
  # label
  # geom_text(aes(label = pH_colorimetric), size = 3, vjust = -1.5, family="serif", show.legend  = FALSE)+
  mytheme_2d

# Soil:H2O = 1:5 method + 0.002M CaCl2
df_pH_CaCl2 <- df_pH_t %>% filter(Method == "H2O_1_5_CaCl2")

ggplot(df_pH_CaCl2, aes(x=H_mM, y=pH_colorimetric, color=Time_days, group=Time_days)) +
  geom_point(size=3, shape=16, alpha=1) +
  geom_line(size=1)+
  # scale_color_brewer(palette='Set1') +
  ylab("pH \n") +
  xlab("\n added [H+] mM") +
  scale_y_continuous(breaks = seq(0,12,1), limits=c(0, 12))+
  ggtitle("[Soil:H2O = 1:5 method + 0.002M CaCl2 method] Soil titration curve with 0.05M HCl/NaOH (NicholsB (pH7.29) filtered supernatant) \n") +
  # label
  # geom_text(aes(label = pH_colorimetric), size = 3, vjust = -1.5, family="serif", show.legend  = FALSE)+
  mytheme_2d

# all 4 methods
ggplot(df_pH_t, aes(x=H_mM, y=pH_colorimetric, color=Time_days, group=Time_days)) +
  geom_point(size=3, shape=16, alpha=1) +
  geom_line(size=1)+
  # scale_color_brewer(palette='Set1') +
  ylab("pH \n") +
  xlab("\n added [H+] mM") +
  scale_y_continuous(breaks = seq(0,12,1), limits=c(0, 12))+
  ggtitle("[Soil:H2O = 1:5 method + 0.002M CaCl2 method] Soil titration curve with 0.05M HCl/NaOH (NicholsB (pH7.29) filtered supernatant) \n") +
  # label
  # geom_text(aes(label = pH_colorimetric), size = 3, vjust = -1.5, family="serif", show.legend  = FALSE)+
  mytheme_2d +
  facet_wrap(Method ~ ., nrow=2) +
  theme(strip.background = element_rect(colour="black", fill="white", size=0.1))


```
