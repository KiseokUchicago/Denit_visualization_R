<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="KiseokUchicago" />

<meta name="date" content="2021-10-21" />

<title>211020_Griess_pipet_confirm</title>

<script src="site_libs/header-attrs-2.9/header-attrs.js"></script>
<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<link rel="icon" href="https://github.com/workflowr/workflowr-assets/raw/master/img/reproducible.png">
<!-- Add a small amount of space between sections. -->
<style type="text/css">
div.section {
  padding-top: 12px;
}
</style>



<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>








<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Denit_visualization_R</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="about.html">About</a>
</li>
<li>
  <a href="license.html">License</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/KiseokUchicago/Denit_visualization_R">
    <span class="fa fa-github"></span>
     
    Source code
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">211020_Griess_pipet_confirm</h1>
<h4 class="author">KiseokUchicago</h4>
<h4 class="date">2021-10-21</h4>

</div>


<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-report" data-toggle="collapse" data-target="#workflowr-report">
<span class="glyphicon glyphicon-list" aria-hidden="true"></span> workflowr <span class="glyphicon glyphicon-exclamation-sign text-danger" aria-hidden="true"></span>
</button>
</p>
<div id="workflowr-report" class="collapse">
<ul class="nav nav-tabs">
<li class="active">
<a data-toggle="tab" href="#summary">Summary</a>
</li>
<li>
<a data-toggle="tab" href="#checks"> Checks <span class="glyphicon glyphicon-exclamation-sign text-danger" aria-hidden="true"></span> </a>
</li>
<li>
<a data-toggle="tab" href="#versions">Past versions</a>
</li>
</ul>
<div class="tab-content">
<div id="summary" class="tab-pane fade in active">
<p>
<strong>Last updated:</strong> 2021-10-21
</p>
<p>
<strong>Checks:</strong> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> 6 <span class="glyphicon glyphicon-exclamation-sign text-danger" aria-hidden="true"></span> 1
</p>
<p>
<strong>Knit directory:</strong> <code>Denit_visualization_R/</code> <span class="glyphicon glyphicon-question-sign" aria-hidden="true" title="This is the local directory in which the code in this file was executed."> </span>
</p>
<p>
This reproducible <a href="http://rmarkdown.rstudio.com">R Markdown</a> analysis was created with <a
  href="https://github.com/jdblischak/workflowr">workflowr</a> (version 1.6.2). The <em>Checks</em> tab describes the reproducibility checks that were applied when the results were created. The <em>Past versions</em> tab lists the development history.
</p>
<hr>
</div>
<div id="checks" class="tab-pane fade">
<div id="workflowr-checks" class="panel-group">
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRMarkdownfilestronguncommittedchanges"> <span class="glyphicon glyphicon-exclamation-sign text-danger" aria-hidden="true"></span> <strong>R Markdown file:</strong> uncommitted changes </a>
</p>
</div>
<div id="strongRMarkdownfilestronguncommittedchanges" class="panel-collapse collapse">
<div class="panel-body">
<p>The R Markdown file has unstaged changes. To know which version of the R Markdown file created these results, you’ll want to first commit it to the Git repo. If you’re still working on the analysis, you can ignore this warning. When you’re finished, you can run <code>wflow_publish</code> to commit the R Markdown file and build the HTML.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongEnvironmentstrongempty"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Environment:</strong> empty </a>
</p>
</div>
<div id="strongEnvironmentstrongempty" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! The global environment was empty. Objects defined in the global environment can affect the analysis in your R Markdown file in unknown ways. For reproduciblity it’s best to always run the code in an empty environment.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSeedstrongcodesetseed20210924code"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Seed:</strong> <code>set.seed(20210924)</code> </a>
</p>
</div>
<div id="strongSeedstrongcodesetseed20210924code" class="panel-collapse collapse">
<div class="panel-body">
<p>The command <code>set.seed(20210924)</code> was run prior to running the code in the R Markdown file. Setting a seed ensures that any results that rely on randomness, e.g. subsampling or permutations, are reproducible.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSessioninformationstrongrecorded"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Session information:</strong> recorded </a>
</p>
</div>
<div id="strongSessioninformationstrongrecorded" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Recording the operating system, R version, and package versions is critical for reproducibility.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongCachestrongnone"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Cache:</strong> none </a>
</p>
</div>
<div id="strongCachestrongnone" class="panel-collapse collapse">
<div class="panel-body">
<p>Nice! There were no cached chunks for this analysis, so you can be confident that you successfully produced the results during this run.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongFilepathsstrongrelative"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>File paths:</strong> relative </a>
</p>
</div>
<div id="strongFilepathsstrongrelative" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Using relative paths to the files within your workflowr project makes it easier to run your code on other machines.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRepositoryversionstrongahrefhttpsgithubcomKiseokUchicagoDenitvisualizationRtreea2e06a93c88d9df4070d1d6e0d67b2eec17f4f80targetblanka2e06a9a"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Repository version:</strong> <a href="https://github.com/KiseokUchicago/Denit_visualization_R/tree/a2e06a93c88d9df4070d1d6e0d67b2eec17f4f80" target="_blank">a2e06a9</a> </a>
</p>
</div>
<div id="strongRepositoryversionstrongahrefhttpsgithubcomKiseokUchicagoDenitvisualizationRtreea2e06a93c88d9df4070d1d6e0d67b2eec17f4f80targetblanka2e06a9a" class="panel-collapse collapse">
<div class="panel-body">
<p>
Great! You are using Git for version control. Tracking code development and connecting the code version to the results is critical for reproducibility.
</p>
<p>
The results in this page were generated with repository version <a href="https://github.com/KiseokUchicago/Denit_visualization_R/tree/a2e06a93c88d9df4070d1d6e0d67b2eec17f4f80" target="_blank">a2e06a9</a>. See the <em>Past versions</em> tab to see a history of the changes made to the R Markdown and HTML files.
</p>
<p>
Note that you need to be careful to ensure that all relevant files for the analysis have been committed to Git prior to generating the results (you can use <code>wflow_publish</code> or <code>wflow_git_commit</code>). workflowr only checks the R Markdown file, but you know if there are other scripts or data files that it depends on. Below is the status of the Git repository when the results were generated:
</p>
<pre><code>
Ignored files:
    Ignored:    .Rhistory
    Ignored:    .Rproj.user/
    Ignored:    Figure_211014_external_lab/

Untracked files:
    Untracked:  210928_pH.pdf
    Untracked:  211014_TN.pdf
    Untracked:  211014_drying_oven_TOC.pdf
    Untracked:  211014_toc_lab.pdf
    Untracked:  211020_df_full_innate.xlsx
    Untracked:  Figure_210911_TOC/
    Untracked:  Figure_210924/
    Untracked:  Figure_210927_TOC/
    Untracked:  Figure_210929/
    Untracked:  Figure_211006/
    Untracked:  Figure_211007/
    Untracked:  Figure_211008/
    Untracked:  Figure_211013/
    Untracked:  data/210911_TOC_sample_plate1.xlsx
    Untracked:  data/210922_Griess_sample_plate1-investigating.xlsx
    Untracked:  data/210922_Griess_sample_plate1.xlsx
    Untracked:  data/210927_TOC_sample_plate1_100ul.xlsx
    Untracked:  data/210927_TOC_sample_plate1_10ul.xlsx
    Untracked:  data/210928_Griess_sample_plate1.xlsx
    Untracked:  data/211005_Griess_sample_plate1.xlsx
    Untracked:  data/211007_Griess_blank_plate1.xlsx
    Untracked:  data/211007_Griess_blank_plate2.xlsx
    Untracked:  data/211008_Griess_blank_plate0.xlsx
    Untracked:  data/211008_Griess_blank_plate1.xlsx
    Untracked:  data/211017_Griess_plate0.xlsx
    Untracked:  data/211017_Griess_plate1.xlsx
    Untracked:  data/211017_Griess_plate2.xlsx
    Untracked:  data/211017_Griess_plate3.xlsx
    Untracked:  data/211017_Griess_plate4.xlsx
    Untracked:  data/211017_Griess_plate5.xlsx
    Untracked:  data/211017_Griess_plate6.xlsx
    Untracked:  data/211017_Griess_plate7.xlsx
    Untracked:  data/211017_Griess_plate8.xlsx
    Untracked:  data/211019_Griess_plate1.xlsx
    Untracked:  data/211020_Griess_plate0.xlsx
    Untracked:  data/211020_Griess_plate1.xlsx
    Untracked:  data/211020_df_full_innate.xlsx
    Untracked:  data/TOC_TN_measurement_2_labs_211014.xlsx
    Untracked:  data/dry_weight_curve(9.5.21).xlsx
    Untracked:  data/pH_data(9.14.21).xlsx
    Untracked:  data/pH_data(9.28.21).xlsx
    Untracked:  df_NO2NO3.xlsx

Unstaged changes:
    Modified:   analysis/211020_Griess_pipet_confirm.Rmd

</code></pre>
<p>
Note that any generated files, e.g. HTML, png, CSS, etc., are not included in this status report because it is ok for generated content to have uncommitted changes.
</p>
</div>
</div>
</div>
</div>
<hr>
</div>
<div id="versions" class="tab-pane fade">

<p>
These are the previous versions of the repository in which changes were made to the R Markdown (<code>analysis/211020_Griess_pipet_confirm.Rmd</code>) and HTML (<code>docs/211020_Griess_pipet_confirm.html</code>) files. If you’ve configured a remote Git repository (see <code>?wflow_git_remote</code>), click on the hyperlinks in the table below to view the files as they were in that past version.
</p>
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
File
</th>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
<th>
Message
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/KiseokUchicago/Denit_visualization_R/blob/a2e06a93c88d9df4070d1d6e0d67b2eec17f4f80/analysis/211020_Griess_pipet_confirm.Rmd" target="_blank">a2e06a9</a>
</td>
<td>
KiseokUchicago
</td>
<td>
2021-10-21
</td>
<td>
all
</td>
</tr>
</tbody>
</table>
</div>
<hr>
</div>
</div>
</div>
<div id="slurry-extraction-pipet-confirmation-griess-assay" class="section level2">
<h2>Slurry extraction pipet confirmation (Griess assay)</h2>
<p>Researcher: <strong>Kiseok Lee</strong><br />
Experiment Date: 10/20/21<br />
Analysis Date: 10/21/21 Lab: <strong>Seppe Kuehn</strong></p>
<pre class="r"><code># libraries
library(dplyr)
library(ggplot2)
library(RColorBrewer)
library(vegan)
library(tidyverse)
library(magrittr)
library(readxl)
library(reshape2)
library(gtools)
library(devtools)
library(openxlsx)
library(ape)
library(stringr)
library(tidyr)
library(ggrepel)
library(ggpubr)

## theme for ggplot
mytheme &lt;- theme_bw() + 
  theme(text = element_text(family=&quot;serif&quot;)) +
  theme(plot.title = element_text(size = 19,hjust = 0.5, family=&quot;serif&quot;)) + 
  theme(axis.title.x = element_text(size = 17,hjust = 0.5, family=&quot;serif&quot;)) + 
  theme(axis.title.y = element_text(size = 17,hjust = 0.5, family=&quot;serif&quot;)) + 
  theme(axis.text.x = element_text(hjust = 0.5, vjust=0.3,size=13, family=&quot;serif&quot;))+
  theme(axis.text.y = element_text(size=10, family=&quot;serif&quot;))+
  theme(panel.grid.major = element_blank()) +
  theme(panel.grid.minor = element_blank(),panel.background=element_blank(),panel.border=element_blank(),plot.background=element_blank()) +
  theme(axis.ticks = element_line(size = 1.1))

mytheme_2d &lt;- theme_bw() + 
  theme(text = element_text(family=&quot;serif&quot;)) +
  theme(plot.title = element_text(size = 19,hjust = 0.5, family=&quot;serif&quot;)) + 
  theme(axis.title.x = element_text(size = 17,hjust = 0.5, family=&quot;serif&quot;)) + 
  theme(axis.title.y = element_text(size = 17,hjust = 0.5, family=&quot;serif&quot;)) + 
  theme(axis.text.x = element_text(hjust = 0.5, vjust=0.3,size=13, family=&quot;serif&quot;))+
  theme(axis.text.y = element_text(size=13, family=&quot;serif&quot;))+
  # theme(panel.grid.major = element_blank()) +
  # theme(panel.grid.minor = element_blank(),panel.background=element_blank(),plot.background=element_blank()) +
  theme(axis.ticks = element_line(size = 1.1))


# color collection
my_color_collection &lt;- c(
  &quot;#CBD588&quot;, &quot;#5F7FC7&quot;, &quot;orange&quot;, &quot;#AD6F3B&quot;, &quot;#673770&quot;, 
  &quot;#D14285&quot;, &quot;#652926&quot;, &quot;#C84248&quot;, &quot;#8569D5&quot;, &quot;#5E738F&quot;,
  &quot;#D1A33D&quot;, &quot;#8A7C64&quot;, &quot;#599861&quot;,&quot;#616163&quot;, &quot;#FFCDB2&quot;,
  &quot;#6D9F71&quot;, &quot;#242F40&quot;,
  &quot;#CCA43B&quot;, &quot;#F92A82&quot;, &quot;#ED7B84&quot;, &quot;#7EB77F&quot;, 
  &quot;#DEC4A1&quot;, &quot;#E5D1D0&quot;, &#39;#0E8482&#39;, &#39;#C9DAEA&#39;, &#39;#337357&#39;, 
  &#39;#95C623&#39;, &#39;#E55812&#39;, &#39;#04471C&#39;, &#39;#F2D7EE&#39;, &#39;#D3BCC0&#39;, 
  &#39;#A5668B&#39;, &#39;#69306D&#39;, &#39;#0E103D&#39;, &#39;#1A535C&#39;, &#39;#4ECDC4&#39;, 
  &#39;#F7FFF7&#39;, &#39;#FF6B6B&#39;, &#39;#FFE66D&#39;, &#39;#6699CC&#39;, &#39;#FFF275&#39;, 
  &#39;#FF8C42&#39;, &#39;#FF3C38&#39;, &#39;#A23E48&#39;, &#39;#000000&#39;, &#39;#CF5C36&#39;, 
  &#39;#EEE5E9&#39;, &#39;#7C7C7C&#39;, &#39;#EFC88B&#39;, &#39;#2E5266&#39;, &#39;#6E8898&#39;, 
  &#39;#9FB1BC&#39;, &#39;#D3D0CB&#39;, &#39;#E2C044&#39;, &#39;#5BC0EB&#39;, &#39;#FDE74C&#39;, 
  &#39;#9BC53D&#39;, &#39;#E55934&#39;, &#39;#FA7921&#39;, &quot;#CD9BCD&quot;, &quot;#508578&quot;, &quot;#DA5724&quot;)

# for git push, use this instead of using wflow_git_push()
# git push -u origin master (in the Git app / in the working directory)</code></pre>
</div>
<div id="import-data-table-from-python-code" class="section level2">
<h2>1. Import data table from python code</h2>
<pre class="r"><code># import file
df_p0 &lt;- openxlsx::read.xlsx(&quot;data/211020_Griess_plate0.xlsx&quot;)
df_p1 &lt;- openxlsx::read.xlsx(&quot;data/211020_Griess_plate1.xlsx&quot;)

head(df_p0)</code></pre>
<pre><code>  Well                   Sample Extraction_method Extraction_ul Nitrate_input
1  A10 Blank_4mM_0.5_1_1.5_50ul         0.5_1_1.5            50             4
2  A11 Blank_4mM_0.5_1_1.5_50ul         0.5_1_1.5            50             4
3  A12 Blank_4mM_0.5_1_1.5_50ul         0.5_1_1.5            50             4
4  B10 Blank_2mM_0.5_1_1.5_50ul         0.5_1_1.5            50             2
5  B11 Blank_2mM_0.5_1_1.5_50ul         0.5_1_1.5            50             2
6  B12 Blank_2mM_0.5_1_1.5_50ul         0.5_1_1.5            50             2
  Sample_type Plate NO2_OD540 NO2NO3_OD540      NO2_mM NO2NO3_mM   NO3_mM
1       Blank    P0   0.00430      3.16110 0.007512610  3.626961 3.619448
2       Blank    P0   0.00405      3.12940 0.007402341  3.568737 3.561335
3       Blank    P0   0.00425      3.21460 0.007490556  3.727945 3.720454
4       Blank    P0   0.00405      1.93435 0.007402341  1.875481 1.868079
5       Blank    P0   0.00510      1.96505 0.007865488  1.911244 1.903379
6       Blank    P0   0.00555      1.91925 0.008063993  1.857991 1.849927</code></pre>
<pre class="r"><code>colnames(df_p0)</code></pre>
<pre><code> [1] &quot;Well&quot;              &quot;Sample&quot;            &quot;Extraction_method&quot;
 [4] &quot;Extraction_ul&quot;     &quot;Nitrate_input&quot;     &quot;Sample_type&quot;      
 [7] &quot;Plate&quot;             &quot;NO2_OD540&quot;         &quot;NO2NO3_OD540&quot;     
[10] &quot;NO2_mM&quot;            &quot;NO2NO3_mM&quot;         &quot;NO3_mM&quot;           </code></pre>
<pre class="r"><code>df_p1 %&lt;&gt;% rename(Well = X1)</code></pre>
<pre><code>Error: Can&#39;t rename columns that don&#39;t exist.
x Column `X1` doesn&#39;t exist.</code></pre>
<pre class="r"><code>dim(df_p1)</code></pre>
<pre><code>[1] 96 13</code></pre>
<pre class="r"><code># remove wells 
df_p1 %&lt;&gt;% filter(!(Well %in% c(&quot;B02&quot;,&quot;H04&quot;)))
dim(df_p1)</code></pre>
<pre><code>[1] 94 13</code></pre>
<pre class="r"><code># bind two dataframe
df_p &lt;- rbind(df_p0, df_p1, df_p2, df_p3, df_p4, df_p5, df_p6, df_p7, df_p8)</code></pre>
<pre><code>Error in rbind(deparse.level, ...): object &#39;df_p2&#39; not found</code></pre>
<pre class="r"><code>dim(df_p)</code></pre>
<pre><code>Error in eval(expr, envir, enclos): object &#39;df_p&#39; not found</code></pre>
<pre class="r"><code>24+96*8 -16</code></pre>
<pre><code>[1] 776</code></pre>
<pre class="r"><code># remove NA
dim(df_p1)</code></pre>
<pre><code>[1] 94 13</code></pre>
<pre class="r"><code>df_p1 &lt;- na.omit(df_p1)
dim(df_p1)</code></pre>
<pre><code>[1] 94 13</code></pre>
<pre class="r"><code>df_p1</code></pre>
<pre><code>   Well                                 Sample Extraction_method Extraction_ul
1   A01       Spike_4mM_0.5_1_1.5_100_300pipet         0.5_1_1.5           100
2   A02       Spike_4mM_0.5_1_1.5_100_300pipet         0.5_1_1.5           100
3   A03       Spike_4mM_0.5_1_1.5_100_300pipet         0.5_1_1.5           100
4   A04      Blank_4mM_0.5_1_1.5_100_1200pipet         0.5_1_1.5           100
5   A05      Blank_4mM_0.5_1_1.5_100_1200pipet         0.5_1_1.5           100
6   A06      Blank_4mM_0.5_1_1.5_100_1200pipet         0.5_1_1.5           100
7   A07        Spike_4mM_0.5_1_1.5_50_300pipet         0.5_1_1.5            50
8   A08        Spike_4mM_0.5_1_1.5_50_300pipet         0.5_1_1.5            50
9   A09        Spike_4mM_0.5_1_1.5_50_300pipet         0.5_1_1.5            50
10  A10       Blank_4mM_0.5_1_1.5_100_300pipet         0.5_1_1.5           100
11  A11       Blank_4mM_0.5_1_1.5_100_300pipet         0.5_1_1.5           100
12  A12       Blank_4mM_0.5_1_1.5_100_300pipet         0.5_1_1.5           100
13  B01       Spike_2mM_0.5_1_1.5_100_300pipet         0.5_1_1.5           100
14  B03       Spike_2mM_0.5_1_1.5_100_300pipet         0.5_1_1.5           100
15  B04      Blank_2mM_0.5_1_1.5_100_1200pipet         0.5_1_1.5           100
16  B05      Blank_2mM_0.5_1_1.5_100_1200pipet         0.5_1_1.5           100
17  B06      Blank_2mM_0.5_1_1.5_100_1200pipet         0.5_1_1.5           100
18  B07        Spike_2mM_0.5_1_1.5_50_300pipet         0.5_1_1.5            50
19  B08        Spike_2mM_0.5_1_1.5_50_300pipet         0.5_1_1.5            50
20  B09        Spike_2mM_0.5_1_1.5_50_300pipet         0.5_1_1.5            50
21  B10       Blank_2mM_0.5_1_1.5_100_300pipet         0.5_1_1.5           100
22  B11       Blank_2mM_0.5_1_1.5_100_300pipet         0.5_1_1.5           100
23  B12       Blank_2mM_0.5_1_1.5_100_300pipet         0.5_1_1.5           100
24  C01       Spike_1mM_0.5_1_1.5_100_300pipet         0.5_1_1.5           100
25  C02       Spike_1mM_0.5_1_1.5_100_300pipet         0.5_1_1.5           100
26  C03       Spike_1mM_0.5_1_1.5_100_300pipet         0.5_1_1.5           100
27  C04      Blank_1mM_0.5_1_1.5_100_1200pipet         0.5_1_1.5           100
28  C05      Blank_1mM_0.5_1_1.5_100_1200pipet         0.5_1_1.5           100
29  C06      Blank_1mM_0.5_1_1.5_100_1200pipet         0.5_1_1.5           100
30  C07        Spike_1mM_0.5_1_1.5_50_300pipet         0.5_1_1.5            50
31  C08        Spike_1mM_0.5_1_1.5_50_300pipet         0.5_1_1.5            50
32  C09        Spike_1mM_0.5_1_1.5_50_300pipet         0.5_1_1.5            50
33  C10       Blank_1mM_0.5_1_1.5_100_300pipet         0.5_1_1.5           100
34  C11       Blank_1mM_0.5_1_1.5_100_300pipet         0.5_1_1.5           100
35  C12       Blank_1mM_0.5_1_1.5_100_300pipet         0.5_1_1.5           100
36  D01     Spike_0.5mM_0.5_1_1.5_100_300pipet         0.5_1_1.5           100
37  D02     Spike_0.5mM_0.5_1_1.5_100_300pipet         0.5_1_1.5           100
38  D03     Spike_0.5mM_0.5_1_1.5_100_300pipet         0.5_1_1.5           100
39  D04    Blank_0.5mM_0.5_1_1.5_100_1200pipet         0.5_1_1.5           100
40  D05    Blank_0.5mM_0.5_1_1.5_100_1200pipet         0.5_1_1.5           100
41  D06    Blank_0.5mM_0.5_1_1.5_100_1200pipet         0.5_1_1.5           100
42  D07      Spike_0.5mM_0.5_1_1.5_50_300pipet         0.5_1_1.5            50
43  D08      Spike_0.5mM_0.5_1_1.5_50_300pipet         0.5_1_1.5            50
44  D09      Spike_0.5mM_0.5_1_1.5_50_300pipet         0.5_1_1.5            50
45  D10     Blank_0.5mM_0.5_1_1.5_100_300pipet         0.5_1_1.5           100
46  D11     Blank_0.5mM_0.5_1_1.5_100_300pipet         0.5_1_1.5           100
47  D12     Blank_0.5mM_0.5_1_1.5_100_300pipet         0.5_1_1.5           100
48  E01    Spike_0.25mM_0.5_1_1.5_100_300pipet         0.5_1_1.5           100
49  E02    Spike_0.25mM_0.5_1_1.5_100_300pipet         0.5_1_1.5           100
50  E03    Spike_0.25mM_0.5_1_1.5_100_300pipet         0.5_1_1.5           100
51  E04   Blank_0.25mM_0.5_1_1.5_100_1200pipet         0.5_1_1.5           100
52  E05   Blank_0.25mM_0.5_1_1.5_100_1200pipet         0.5_1_1.5           100
53  E06   Blank_0.25mM_0.5_1_1.5_100_1200pipet         0.5_1_1.5           100
54  E07     Spike_0.25mM_0.5_1_1.5_50_300pipet         0.5_1_1.5            50
55  E08     Spike_0.25mM_0.5_1_1.5_50_300pipet         0.5_1_1.5            50
56  E09     Spike_0.25mM_0.5_1_1.5_50_300pipet         0.5_1_1.5            50
57  E10    Blank_0.25mM_0.5_1_1.5_100_300pipet         0.5_1_1.5           100
58  E11    Blank_0.25mM_0.5_1_1.5_100_300pipet         0.5_1_1.5           100
59  E12    Blank_0.25mM_0.5_1_1.5_100_300pipet         0.5_1_1.5           100
60  F01   Spike_0.125mM_0.5_1_1.5_100_300pipet         0.5_1_1.5           100
61  F02   Spike_0.125mM_0.5_1_1.5_100_300pipet         0.5_1_1.5           100
62  F03   Spike_0.125mM_0.5_1_1.5_100_300pipet         0.5_1_1.5           100
63  F04  Blank_0.125mM_0.5_1_1.5_100_1200pipet         0.5_1_1.5           100
64  F05  Blank_0.125mM_0.5_1_1.5_100_1200pipet         0.5_1_1.5           100
65  F06  Blank_0.125mM_0.5_1_1.5_100_1200pipet         0.5_1_1.5           100
66  F07    Spike_0.125mM_0.5_1_1.5_50_300pipet         0.5_1_1.5            50
67  F08    Spike_0.125mM_0.5_1_1.5_50_300pipet         0.5_1_1.5            50
68  F09    Spike_0.125mM_0.5_1_1.5_50_300pipet         0.5_1_1.5            50
69  F10   Blank_0.125mM_0.5_1_1.5_100_300pipet         0.5_1_1.5           100
70  F11   Blank_0.125mM_0.5_1_1.5_100_300pipet         0.5_1_1.5           100
71  F12   Blank_0.125mM_0.5_1_1.5_100_300pipet         0.5_1_1.5           100
72  G01  Spike_0.0625mM_0.5_1_1.5_100_300pipet         0.5_1_1.5           100
73  G02  Spike_0.0625mM_0.5_1_1.5_100_300pipet         0.5_1_1.5           100
74  G03  Spike_0.0625mM_0.5_1_1.5_100_300pipet         0.5_1_1.5           100
75  G04 Blank_0.0625mM_0.5_1_1.5_100_1200pipet         0.5_1_1.5           100
76  G05 Blank_0.0625mM_0.5_1_1.5_100_1200pipet         0.5_1_1.5           100
77  G06 Blank_0.0625mM_0.5_1_1.5_100_1200pipet         0.5_1_1.5           100
78  G07   Spike_0.0625mM_0.5_1_1.5_50_300pipet         0.5_1_1.5            50
79  G08   Spike_0.0625mM_0.5_1_1.5_50_300pipet         0.5_1_1.5            50
80  G09   Spike_0.0625mM_0.5_1_1.5_50_300pipet         0.5_1_1.5            50
81  G10  Blank_0.0625mM_0.5_1_1.5_100_300pipet         0.5_1_1.5           100
82  G11  Blank_0.0625mM_0.5_1_1.5_100_300pipet         0.5_1_1.5           100
83  G12  Blank_0.0625mM_0.5_1_1.5_100_300pipet         0.5_1_1.5           100
84  H01       Spike_0mM_0.5_1_1.5_100_300pipet         0.5_1_1.5           100
85  H02       Spike_0mM_0.5_1_1.5_100_300pipet         0.5_1_1.5           100
86  H03       Spike_0mM_0.5_1_1.5_100_300pipet         0.5_1_1.5           100
87  H05      Blank_0mM_0.5_1_1.5_100_1200pipet         0.5_1_1.5           100
88  H06      Blank_0mM_0.5_1_1.5_100_1200pipet         0.5_1_1.5           100
89  H07        Spike_0mM_0.5_1_1.5_50_300pipet         0.5_1_1.5            50
90  H08        Spike_0mM_0.5_1_1.5_50_300pipet         0.5_1_1.5            50
91  H09        Spike_0mM_0.5_1_1.5_50_300pipet         0.5_1_1.5            50
92  H10       Blank_0mM_0.5_1_1.5_100_300pipet         0.5_1_1.5           100
93  H11       Blank_0mM_0.5_1_1.5_100_300pipet         0.5_1_1.5           100
94  H12       Blank_0mM_0.5_1_1.5_100_300pipet         0.5_1_1.5           100
   Nitrate_input Sample_type     Pipet Plate NO2_OD540 NO2NO3_OD540      NO2_mM
1         4.0000       Spike  300pipet    P1   0.00705      3.18355 0.008725730
2         4.0000       Spike  300pipet    P1   0.00795      3.00535 0.009122813
3         4.0000       Spike  300pipet    P1   0.00830      3.05030 0.009277242
4         4.0000       Blank 1200pipet    P1   0.00810      2.98320 0.009188996
5         4.0000       Blank 1200pipet    P1   0.00825      2.96165 0.009255181
6         4.0000       Blank 1200pipet    P1   0.00975      3.07680 0.009917071
7         4.0000       Spike  300pipet    P1   0.00770      3.01200 0.009012509
8         4.0000       Spike  300pipet    P1   0.00895      2.87385 0.009564052
9         4.0000       Spike  300pipet    P1   0.00885      2.96915 0.009519927
10        4.0000       Blank  300pipet    P1   0.00630      2.88400 0.008394851
11        4.0000       Blank  300pipet    P1   0.00700      3.10220 0.008703671
12        4.0000       Blank  300pipet    P1   0.00845      2.98435 0.009343428
13        2.0000       Spike  300pipet    P1   0.00720      1.96780 0.008791908
14        2.0000       Spike  300pipet    P1   0.00965      1.98120 0.009872942
15        2.0000       Blank 1200pipet    P1   0.00750      2.04080 0.008924268
16        2.0000       Blank 1200pipet    P1   0.00660      2.01445 0.008527200
17        2.0000       Blank 1200pipet    P1   0.00825      2.06590 0.009255181
18        2.0000       Spike  300pipet    P1   0.00670      1.91585 0.008571317
19        2.0000       Spike  300pipet    P1   0.00785      1.80550 0.009078691
20        2.0000       Spike  300pipet    P1   0.00980      1.92565 0.009939135
21        2.0000       Blank  300pipet    P1   0.00425      1.90215 0.007490556
22        2.0000       Blank  300pipet    P1   0.00615      2.02140 0.008328678
23        2.0000       Blank  300pipet    P1   0.00615      1.86525 0.008328678
24        1.0000       Spike  300pipet    P1   0.01025      1.14170 0.010137720
25        1.0000       Spike  300pipet    P1   0.01080      1.14070 0.010380445
26        1.0000       Spike  300pipet    P1   0.00940      1.15175 0.009762622
27        1.0000       Blank 1200pipet    P1   0.00825      1.14995 0.009255181
28        1.0000       Blank 1200pipet    P1   0.00970      1.19195 0.009895006
29        1.0000       Blank 1200pipet    P1   0.01140      1.23145 0.010645248
30        1.0000       Spike  300pipet    P1   0.00925      1.16550 0.009696431
31        1.0000       Spike  300pipet    P1   0.00935      1.06965 0.009740559
32        1.0000       Spike  300pipet    P1   0.01185      1.10215 0.010843860
33        1.0000       Blank  300pipet    P1   0.00840      1.05810 0.009321366
34        1.0000       Blank  300pipet    P1   0.00760      1.05920 0.008968388
35        1.0000       Blank  300pipet    P1   0.00935      1.05715 0.009740559
36        0.5000       Spike  300pipet    P1   0.00900      0.66395 0.009586115
37        0.5000       Spike  300pipet    P1   0.00850      0.65320 0.009365490
38        0.5000       Spike  300pipet    P1   0.00950      0.67500 0.009806750
39        0.5000       Blank 1200pipet    P1   0.00855      0.71265 0.009387552
40        0.5000       Blank 1200pipet    P1   0.00850      0.66150 0.009365490
41        0.5000       Blank 1200pipet    P1   0.00830      0.72365 0.009277242
42        0.5000       Spike  300pipet    P1   0.00710      0.62675 0.008747789
43        0.5000       Spike  300pipet    P1   0.01115      0.64055 0.010534912
44        0.5000       Spike  300pipet    P1   0.00970      0.66560 0.009895006
45        0.5000       Blank  300pipet    P1   0.00500      0.56250 0.007821377
46        0.5000       Blank  300pipet    P1   0.00430      0.55445 0.007512610
47        0.5000       Blank  300pipet    P1   0.00455      0.55680 0.007622882
48        0.2500       Spike  300pipet    P1   0.00955      0.40945 0.009828814
49        0.2500       Spike  300pipet    P1   0.00955      0.41355 0.009828814
50        0.2500       Spike  300pipet    P1   0.00885      0.41885 0.009519927
51        0.2500       Blank 1200pipet    P1   0.00940      0.43055 0.009762622
52        0.2500       Blank 1200pipet    P1   0.01140      0.41005 0.010645248
53        0.2500       Blank 1200pipet    P1   0.00955      0.43515 0.009828814
54        0.2500       Spike  300pipet    P1   0.00885      0.41360 0.009519927
55        0.2500       Spike  300pipet    P1   0.01075      0.40775 0.010358378
56        0.2500       Spike  300pipet    P1   0.00870      0.41830 0.009453739
57        0.2500       Blank  300pipet    P1   0.00620      0.29040 0.008350735
58        0.2500       Blank  300pipet    P1   0.00840      0.28945 0.009321366
59        0.2500       Blank  300pipet    P1   0.00675      0.28700 0.008593376
60        0.1250       Spike  300pipet    P1   0.01025      0.27165 0.010137720
61        0.1250       Spike  300pipet    P1   0.01120      0.27470 0.010556979
62        0.1250       Spike  300pipet    P1   0.00935      0.27845 0.009740559
63        0.1250       Blank 1200pipet    P1   0.00865      0.26685 0.009431676
64        0.1250       Blank 1200pipet    P1   0.00955      0.27255 0.009828814
65        0.1250       Blank 1200pipet    P1   0.01020      0.29665 0.010115654
66        0.1250       Spike  300pipet    P1   0.01010      0.25900 0.010071524
67        0.1250       Spike  300pipet    P1   0.01065      0.26950 0.010314246
68        0.1250       Spike  300pipet    P1   0.00805      0.27475 0.009166935
69        0.1250       Blank  300pipet    P1   0.00405      0.14400 0.007402341
70        0.1250       Blank  300pipet    P1   0.00640      0.14690 0.008438967
71        0.1250       Blank  300pipet    P1   0.00765      0.14660 0.008990449
72        0.0625       Spike  300pipet    P1   0.00940      0.21705 0.009762622
73        0.0625       Spike  300pipet    P1   0.00955      0.20685 0.009828814
74        0.0625       Spike  300pipet    P1   0.01195      0.21735 0.010887997
75        0.0625       Blank 1200pipet    P1   0.00980      0.22020 0.009939135
76        0.0625       Blank 1200pipet    P1   0.00850      0.19845 0.009365490
77        0.0625       Blank 1200pipet    P1   0.00830      0.22535 0.009277242
78        0.0625       Spike  300pipet    P1   0.00845      0.21290 0.009343428
79        0.0625       Spike  300pipet    P1   0.00820      0.21145 0.009233119
80        0.0625       Spike  300pipet    P1   0.01015      0.21700 0.010093589
81        0.0625       Blank  300pipet    P1   0.00350      0.07745 0.007159756
82        0.0625       Blank  300pipet    P1   0.00445      0.07455 0.007578773
83        0.0625       Blank  300pipet    P1   0.00505      0.07850 0.007843433
84        0.0000       Spike  300pipet    P1   0.01025      0.14640 0.010137720
85        0.0000       Spike  300pipet    P1   0.01000      0.14890 0.010027394
86        0.0000       Spike  300pipet    P1   0.00955      0.14685 0.009828814
87        0.0000       Blank 1200pipet    P1   0.01080      0.15295 0.010380445
88        0.0000       Blank 1200pipet    P1   0.01180      0.15260 0.010821792
89        0.0000       Spike  300pipet    P1   0.00800      0.11685 0.009144874
90        0.0000       Spike  300pipet    P1   0.01020      0.14720 0.010115654
91        0.0000       Spike  300pipet    P1   0.01100      0.15085 0.010468711
92        0.0000       Blank  300pipet    P1   0.00455      0.00300 0.007622882
93        0.0000       Blank  300pipet    P1   0.00545      0.00615 0.008019880
94        0.0000       Blank  300pipet    P1   0.00440      0.00305 0.007556719
     NO2NO3_mM      NO3_mM
1  3.668905895 3.660180165
2  3.351053627 3.341930814
3  3.428180000 3.418902757
4  3.313723321 3.304534325
5  3.277812491 3.268557310
6  3.474554498 3.464637427
7  3.362346379 3.353333870
8  3.135400662 3.125836610
9  3.290265624 3.280745698
10 3.151559215 3.143164364
11 3.519669295 3.510965625
12 3.315650871 3.306307443
13 1.914461172 1.905669263
14 1.930168598 1.920295656
15 2.000687976 1.991763708
16 1.969376576 1.960849377
17 2.030715601 2.021460420
18 1.854061878 1.845490561
19 1.728272234 1.719193543
20 1.865396226 1.855457091
21 1.838262589 1.830772033
22 1.977614378 1.969285700
23 1.795969270 1.787640592
24 1.031733712 1.021595992
25 1.030750663 1.020370218
26 1.041623092 1.031860470
27 1.039850556 1.030595375
28 1.081359333 1.071464327
29 1.120686732 1.110041484
30 1.055182154 1.045485722
31 0.961347323 0.951606765
32 0.992986602 0.982142742
33 0.950146237 0.940824871
34 0.951212042 0.942243654
35 0.949225932 0.939485373
36 0.580479146 0.570893031
37 0.570716862 0.561351372
38 0.590530523 0.580723774
39 0.624905926 0.615518374
40 0.578252850 0.568887360
41 0.634986892 0.625709650
42 0.546764646 0.538016857
43 0.559249513 0.548714602
44 0.581978956 0.572083949
45 0.488976030 0.481154653
46 0.481774362 0.474261752
47 0.483875829 0.476252947
48 0.353487077 0.343658263
49 0.357078022 0.347249208
50 0.361723061 0.352203134
51 0.371989562 0.362226940
52 0.354012451 0.343367203
53 0.376030637 0.366201823
54 0.357121826 0.347601900
55 0.351998758 0.341640380
56 0.361240866 0.351787128
57 0.250110332 0.241759596
58 0.249292219 0.239970853
59 0.247182841 0.238589465
60 0.233982962 0.223845242
61 0.236603543 0.226046564
62 0.239827060 0.230086502
63 0.229860967 0.220429291
64 0.234756135 0.224927321
65 0.255495299 0.245379644
66 0.223125573 0.213054049
67 0.232136319 0.221822074
68 0.236646513 0.227479577
69 0.125263128 0.117860787
70 0.127712645 0.119273679
71 0.127459204 0.118468755
72 0.187252761 0.177490139
73 0.178560917 0.168732103
74 0.187508583 0.176620586
75 0.189939406 0.180000271
76 0.171411816 0.162046326
77 0.194334303 0.185057061
78 0.183714942 0.174371514
79 0.182479300 0.173246181
80 0.187210125 0.177116536
81 0.069305200 0.062145443
82 0.066877739 0.059298966
83 0.070184332 0.062340899
84 0.127290248 0.117152528
85 0.129402512 0.119375118
86 0.127670404 0.117841591
87 0.132825854 0.122445409
88 0.132529937 0.121708146
89 0.102375693 0.093230819
90 0.127966097 0.117850443
91 0.131050560 0.120581849
92 0.007271488 0.000000000
93 0.009884237 0.001864357
94 0.007312952 0.000000000</code></pre>
<pre class="r"><code># Check
df_p1 %&gt;% filter(Well ==&quot;B02&quot;)</code></pre>
<pre><code> [1] Well              Sample            Extraction_method Extraction_ul    
 [5] Nitrate_input     Sample_type       Pipet             Plate            
 [9] NO2_OD540         NO2NO3_OD540      NO2_mM            NO2NO3_mM        
[13] NO3_mM           
&lt;0 rows&gt; (or 0-length row.names)</code></pre>
<pre class="r"><code>df_p1 %&gt;% filter(Well ==&quot;H04&quot;)</code></pre>
<pre><code> [1] Well              Sample            Extraction_method Extraction_ul    
 [5] Nitrate_input     Sample_type       Pipet             Plate            
 [9] NO2_OD540         NO2NO3_OD540      NO2_mM            NO2NO3_mM        
[13] NO3_mM           
&lt;0 rows&gt; (or 0-length row.names)</code></pre>
</div>
<div id="get-average-and-standard-deviation" class="section level2">
<h2>2. Get average and standard deviation</h2>
<pre class="r"><code># average and standard deviation

# plot to see
ggplot(df_p1, aes(x=Nitrate_input, y=NO3_mM, color=Sample_type, group=Sample_type)) +
  geom_point(size=2.5, shape=21) +
  # geom_line(size=1)+
  scale_fill_brewer(palette=&#39;Set2&#39;) +
  ylab(&quot;NO3- (mM) \n&quot;) +
  xlab(&quot;\n Nitrate_spike_in (mM)&quot;) +
  # scale_y_continuous(breaks = seq(0,0.3,0.05), limits=c(0, 0.3))+
  ggtitle(&quot;Without averaging \n&quot;) +
  mytheme_2d</code></pre>
<p><img src="figure/211020_Griess_pipet_confirm.Rmd/unnamed-chunk-3-1.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code># average technical replicate
df_NO2NO3 &lt;- df_p1 %&gt;% group_by(Sample, Extraction_method, Extraction_ul, Nitrate_input, Sample_type, Trouble_shooting) %&gt;% summarise(Ave_NO2_mM = mean(NO2_mM), Std_NO2_mM = sd(NO2_mM), Ave_NO2NO3_mM = mean(NO2NO3_mM), Std_NO2NO3_mM = sd(NO2NO3_mM), Ave_NO3_mM = mean(NO3_mM), Std_NO3_mM = sd(NO3_mM)) %&gt;% ungroup()</code></pre>
<pre><code>Error: Must group by variables found in `.data`.
* Column `Trouble_shooting` is not found.</code></pre>
<pre class="r"><code>dim(df_NO2NO3)</code></pre>
<pre><code>Error in eval(expr, envir, enclos): object &#39;df_NO2NO3&#39; not found</code></pre>
<pre class="r"><code># plot to see
ggplot(df_NO2NO3, aes(x=Nitrate_input, y=Ave_NO3_mM, color=Sample_type, group=Sample_type)) +
  geom_point(size=2.5, shape=21) +
  # geom_line(size=1)+
  geom_errorbar(aes(ymin=Ave_NO3_mM - Std_NO3_mM, ymax=Ave_NO3_mM + Std_NO3_mM), width=.05)+
  scale_fill_brewer(palette=&#39;Set2&#39;) +
  ylab(&quot;NO3- (mM) \n&quot;) +
  xlab(&quot;\n Nitrate_spike_in (mM)&quot;) +
  # scale_y_continuous(breaks = seq(0,0.3,0.05), limits=c(0, 0.3))+
  ggtitle(&quot;After averaging with technical replicates \n&quot;) +
  mytheme_2d</code></pre>
<pre><code>Error in ggplot(df_NO2NO3, aes(x = Nitrate_input, y = Ave_NO3_mM, color = Sample_type, : object &#39;df_NO2NO3&#39; not found</code></pre>
<pre class="r"><code># average biological replicates
# standard deviation is the standard deviation of the technical replicate average
dim(df_NO2NO3)</code></pre>
<pre><code>Error in eval(expr, envir, enclos): object &#39;df_NO2NO3&#39; not found</code></pre>
<pre class="r"><code>head(df_NO2NO3)</code></pre>
<pre><code>Error in head(df_NO2NO3): object &#39;df_NO2NO3&#39; not found</code></pre>
<pre class="r"><code># Factor in orders
# df_all$Sample_type &lt;-  factor(df_all$Sample_type, levels = c(&quot;Soil&quot;,&quot;Blank&quot;))</code></pre>
</div>
<div id="plot-per-method" class="section level2">
<h2>3. Plot per method</h2>
</div>
<div id="full-extraction-testing" class="section level2">
<h2>3.1. Full extraction testing</h2>
<pre class="r"><code>df_full &lt;- df_NO2NO3 %&gt;% filter((Trouble_shooting  == &quot;Full&quot;))</code></pre>
<pre><code>Error in filter(., (Trouble_shooting == &quot;Full&quot;)): object &#39;df_NO2NO3&#39; not found</code></pre>
<pre class="r"><code>colnames(df_full)</code></pre>
<pre><code>Error in is.data.frame(x): object &#39;df_full&#39; not found</code></pre>
<pre class="r"><code>ggplot(df_full, aes(x=Nitrate_input, y=Ave_NO3_mM, color=Extraction_method, group=Extraction_method)) +
  geom_point(size=2.5, shape=21) +
  # geom_line(size=1)+
  geom_errorbar(aes(ymin=Ave_NO3_mM - Std_NO3_mM, ymax=Ave_NO3_mM + Std_NO3_mM), width=.05)+
  # scale_color_brewer(palette=&#39;Set2&#39;) +
  # scale_color_manual(values = c(&quot;deepskyblue4&quot;,&quot;maroon2&quot;))+
  ylab(&quot;Measured NO3- (mM) \n&quot;) +
  xlab(&quot;\n Nitrate_spike_in (mM)&quot;) +
  scale_y_continuous(breaks = seq(0,1.5,0.25), limits=c(0, 1.5))+
  scale_x_continuous(breaks = seq(0,1.5,0.25), limits=c(0, 1.5))+
  ggtitle(&quot;Full extraction \n&quot;) +
  geom_abline(slope = 1, intercept=0, show.legend = &quot;y=x&quot;)+
  mytheme_2d</code></pre>
<pre><code>Error in ggplot(df_full, aes(x = Nitrate_input, y = Ave_NO3_mM, color = Extraction_method, : object &#39;df_full&#39; not found</code></pre>
<pre class="r"><code># get extraction ratio
# innate nitrate
add_innate &lt;- df_full %&gt;% filter(Sample_type== &quot;Spike&quot;, Nitrate_input == 0) %&gt;% arrange(Extraction_method) %&gt;% rename(Innate_NO3_mM = Ave_NO3_mM) %&gt;% select(Extraction_method, Innate_NO3_mM)</code></pre>
<pre><code>Error in filter(., Sample_type == &quot;Spike&quot;, Nitrate_input == 0): object &#39;df_full&#39; not found</code></pre>
<pre class="r"><code>df_full_innate &lt;- df_full %&gt;% filter(Sample_type== &quot;Spike&quot;, Nitrate_input != 0) %&gt;% arrange(Extraction_method) %&gt;%
  left_join(add_innate, by=c(&quot;Extraction_method&quot;=&quot;Extraction_method&quot;)) %&gt;% 
  mutate(Retrieved_NO3_mM = Ave_NO3_mM - Innate_NO3_mM)</code></pre>
<pre><code>Error in filter(., Sample_type == &quot;Spike&quot;, Nitrate_input != 0): object &#39;df_full&#39; not found</code></pre>
<pre class="r"><code># Export to excel
openxlsx::write.xlsx(df_full_innate, &quot;211020_df_full_innate.xlsx&quot;)</code></pre>
<pre><code>Error in &quot;list&quot; %in% class(x): object &#39;df_full_innate&#39; not found</code></pre>
<pre class="r"><code># plot
ggplot(df_full_innate, aes(x=Nitrate_input, y=Retrieved_NO3_mM, color=Extraction_method, group=Extraction_method)) +
  geom_point(size=2.5, shape=21) +
  # geom_line(size=1)+
  geom_errorbar(aes(ymin=Retrieved_NO3_mM - Std_NO3_mM, ymax=Retrieved_NO3_mM + Std_NO3_mM), width=.05)+
  # scale_fill_brewer(palette=&#39;Set2&#39;) +
  # scale_color_manual(values = c(&quot;brown3&quot;,&quot;deepskyblue2&quot;))+
  ylab(&quot;Retrieved NO3 concentrations (mM) \n&quot;) +
  xlab(&quot;\n Nitrate_spike_in (mM)&quot;) +
  scale_y_continuous(breaks = seq(0,1,0.25), limits=c(0, 1))+
  scale_x_continuous(breaks = seq(0,1,0.25), limits=c(0, 1))+
  ggtitle(&quot;Full extraction \n&quot;) +
  geom_abline(slope = 1, intercept=0, show.legend = &quot;y=x&quot;)+
  mytheme_2d</code></pre>
<pre><code>Error in ggplot(df_full_innate, aes(x = Nitrate_input, y = Retrieved_NO3_mM, : object &#39;df_full_innate&#39; not found</code></pre>
<pre class="r"><code># Retrieved ratio of spike ins
df_full_innate$Ratio_retrieved &lt;- df_full_innate$Retrieved_NO3_mM / df_full_innate$Nitrate_input </code></pre>
<pre><code>Error in eval(expr, envir, enclos): object &#39;df_full_innate&#39; not found</code></pre>
<pre class="r"><code>ggplot(df_full_innate, aes(x=Nitrate_input, y=Ratio_retrieved, fill=Extraction_method, group=Extraction_method)) +  ## I put fill=value which was wrong
  geom_bar(stat=&quot;identity&quot;,position=&quot;dodge&quot;)+
  geom_line(size=0.2, color=&quot;brown&quot;)+
  ylab(&quot;Ratio of retrieved nitrate concentraion \n&quot;) +
  xlab(&quot;\n Nitrate_spike_in (mM)&quot;) +
  # scale_y_continuous(breaks = seq(0,1,0.1), limits=c(0, 1))+
  # scale_x_continuous(breaks = seq(0,2.1,0.25), limits=c(0, 2.1))+
  ggtitle(&quot;Full extraction \n&quot;) +
  geom_text(aes(label = round(Ratio_retrieved,3)), size = 3, vjust = -1.5, family=&quot;serif&quot;, show.legend = FALSE)+
  mytheme_2d</code></pre>
<pre><code>Error in ggplot(df_full_innate, aes(x = Nitrate_input, y = Ratio_retrieved, : object &#39;df_full_innate&#39; not found</code></pre>
</div>
<div id="trouble-shooting" class="section level2">
<h2>3.2. Trouble shooting</h2>
<pre class="r"><code># Get the trouble shooting data
df_ts &lt;- df_NO2NO3 %&gt;% filter(!(Trouble_shooting  == &quot;Full&quot;))</code></pre>
<pre><code>Error in filter(., !(Trouble_shooting == &quot;Full&quot;)): object &#39;df_NO2NO3&#39; not found</code></pre>
<pre class="r"><code>dim(df_ts)</code></pre>
<pre><code>Error in eval(expr, envir, enclos): object &#39;df_ts&#39; not found</code></pre>
<pre class="r"><code># Trouble shooting - fast
df_ts_fast &lt;- df_ts %&gt;% filter(Trouble_shooting == &quot;Fast&quot;)</code></pre>
<pre><code>Error in filter(., Trouble_shooting == &quot;Fast&quot;): object &#39;df_ts&#39; not found</code></pre>
<pre class="r"><code>ggplot(df_ts_fast, aes(x=Nitrate_input, y=Ave_NO3_mM, color=Trouble_shooting, group=Trouble_shooting)) +
  geom_point(size=2.5, shape=21) +
  # geom_line(size=1)+
  geom_errorbar(aes(ymin=Ave_NO3_mM - Std_NO3_mM, ymax=Ave_NO3_mM + Std_NO3_mM), width=.05)+
  # scale_color_brewer(palette=&#39;Set2&#39;) +
  # scale_color_manual(values = c(&quot;deepskyblue4&quot;,&quot;maroon2&quot;))+
  ylab(&quot;Measured NO3- (mM) \n&quot;) +
  xlab(&quot;\n Nitrate_spike_in (mM)&quot;) +
  scale_y_continuous(breaks = seq(0,2.3,0.25), limits=c(0, 2.3))+
  scale_x_continuous(breaks = seq(0,2.3,0.25), limits=c(0, 2.3))+
  ggtitle(&quot;Fast 0.5:1:1.5 (soil:water:KCl) method-100ul extraction \n&quot;) +
  geom_abline(slope = 1, intercept=0, show.legend = &quot;y=x&quot;)+
  mytheme_2d</code></pre>
<pre><code>Error in ggplot(df_ts_fast, aes(x = Nitrate_input, y = Ave_NO3_mM, color = Trouble_shooting, : object &#39;df_ts_fast&#39; not found</code></pre>
<pre class="r"><code># subtract innate nitrate in soil
df_ts_fast_soil &lt;- df_ts_fast %&gt;% filter(Sample_type == &quot;Spike&quot;)</code></pre>
<pre><code>Error in filter(., Sample_type == &quot;Spike&quot;): object &#39;df_ts_fast&#39; not found</code></pre>
<pre class="r"><code>innate_no3 &lt;- df_ts_fast %&gt;% filter(Sample_type== &quot;Spike&quot;, Nitrate_input == 0) %&gt;% select(Ave_NO3_mM) %&gt;% unlist()</code></pre>
<pre><code>Error in filter(., Sample_type == &quot;Spike&quot;, Nitrate_input == 0): object &#39;df_ts_fast&#39; not found</code></pre>
<pre class="r"><code>df_ts_fast_soil$Retrieved_NO3_mM &lt;- df_ts_fast_soil$Ave_NO3_mM - innate_no3</code></pre>
<pre><code>Error in eval(expr, envir, enclos): object &#39;df_ts_fast_soil&#39; not found</code></pre>
<pre class="r"><code>ggplot(df_ts_fast_soil, aes(x=Nitrate_input, y=Retrieved_NO3_mM, color=Trouble_shooting, group=Trouble_shooting)) +
  geom_point(size=2.5, shape=21) +
  # geom_line(size=1)+
  geom_errorbar(aes(ymin=Retrieved_NO3_mM - Std_NO3_mM, ymax=Retrieved_NO3_mM + Std_NO3_mM), width=.05)+
  # scale_fill_brewer(palette=&#39;Set2&#39;) +
  scale_color_manual(values = c(&quot;brown3&quot;,&quot;deepskyblue2&quot;))+
  ylab(&quot;Retrieved NO3 concentrations (mM) \n&quot;) +
  xlab(&quot;\n Nitrate_spike_in (mM)&quot;) +
  # scale_y_continuous(breaks = seq(0,2.1,0.25), limits=c(0, 2))+
  # scale_x_continuous(breaks = seq(0,2.1,0.25), limits=c(0, 2))+
  ggtitle(&quot;Fast 0.5:1:1.5 (soil:water:KCl) method-100ul extraction \n&quot;) +
  geom_abline(slope = 1, intercept=0, show.legend = &quot;y=x&quot;)+
  mytheme_2d</code></pre>
<pre><code>Error in ggplot(df_ts_fast_soil, aes(x = Nitrate_input, y = Retrieved_NO3_mM, : object &#39;df_ts_fast_soil&#39; not found</code></pre>
<pre class="r"><code># Retrieved ratio of spike ins
df_ts_fast_soil$Ratio_retrieved &lt;- df_ts_fast_soil$Retrieved_NO3_mM / df_ts_fast_soil$Nitrate_input </code></pre>
<pre><code>Error in eval(expr, envir, enclos): object &#39;df_ts_fast_soil&#39; not found</code></pre>
<pre class="r"><code>ggplot(df_ts_fast_soil, aes(x=Nitrate_input, y=Ratio_retrieved)) +  ## I put fill=value which was wrong
  geom_bar(stat=&quot;identity&quot;,position=&quot;dodge&quot;, fill=&quot;brown3&quot;)+
  geom_line(size=0.2, color=&quot;brown&quot;)+
  ylab(&quot;Ratio of retrieved nitrate concentraion \n&quot;) +
  xlab(&quot;\n Nitrate_spike_in (mM)&quot;) +
  # scale_y_continuous(breaks = seq(0,1,0.1), limits=c(0, 1))+
  # scale_x_continuous(breaks = seq(0,2.1,0.25), limits=c(0, 2.1))+
  ggtitle(&quot;Fast 0.5:1:1.5 (soil:water:KCl) method-100ul extraction \n&quot;) +
  geom_text(aes(label = round(Ratio_retrieved,3)), size = 3, vjust = -1.5, family=&quot;serif&quot;, show.legend = FALSE)+
  mytheme_2d</code></pre>
<pre><code>Error in ggplot(df_ts_fast_soil, aes(x = Nitrate_input, y = Ratio_retrieved)): object &#39;df_ts_fast_soil&#39; not found</code></pre>
<p>Show all trouble shooting at once</p>
<pre class="r"><code>ggplot(df_ts, aes(x=Nitrate_input, y=Ave_NO3_mM, color=Trouble_shooting, group=Trouble_shooting)) +
  geom_point(size=2.5, shape=21) +
  # geom_line(size=1)+
  geom_errorbar(aes(ymin=Ave_NO3_mM - Std_NO3_mM, ymax=Ave_NO3_mM + Std_NO3_mM), width=.05)+
  # scale_color_brewer(palette=&#39;Set2&#39;) +
  # scale_color_manual(values = c(&quot;deepskyblue4&quot;,&quot;maroon2&quot;))+
  ylab(&quot;Measured NO3- (mM) \n&quot;) +
  xlab(&quot;\n Nitrate_spike_in (mM)&quot;) +
  scale_y_continuous(breaks = seq(0,2.3,0.25), limits=c(0, 2.3))+
  scale_x_continuous(breaks = seq(0,2.3,0.25), limits=c(0, 2.3))+
  ggtitle(&quot;0.5:1:1.5 (soil:water:KCl) method-100ul extraction w/ 300ul pipet \n&quot;) +
  geom_abline(slope = 1, intercept=0, show.legend = &quot;y=x&quot;)+
  mytheme_2d</code></pre>
<pre><code>Error in ggplot(df_ts, aes(x = Nitrate_input, y = Ave_NO3_mM, color = Trouble_shooting, : object &#39;df_ts&#39; not found</code></pre>
<pre class="r"><code># subtract innate nitrate in soil
ts_innate &lt;- df_ts %&gt;% filter(Sample_type== &quot;Spike&quot;, Nitrate_input == 0) %&gt;% arrange(Extraction_method) %&gt;% rename(Innate_NO3_mM = Ave_NO3_mM) %&gt;% select(Trouble_shooting, Innate_NO3_mM)</code></pre>
<pre><code>Error in filter(., Sample_type == &quot;Spike&quot;, Nitrate_input == 0): object &#39;df_ts&#39; not found</code></pre>
<pre class="r"><code>df_ts_innate &lt;- df_ts %&gt;% filter(Sample_type== &quot;Spike&quot;, Nitrate_input != 0) %&gt;% arrange(Extraction_method) %&gt;%
  left_join(ts_innate, by=c(&quot;Trouble_shooting&quot;=&quot;Trouble_shooting&quot;)) %&gt;% 
  mutate(Retrieved_NO3_mM = Ave_NO3_mM - Innate_NO3_mM) %&gt;% 
  mutate(Ratio_retrieved = Retrieved_NO3_mM/Nitrate_input)</code></pre>
<pre><code>Error in filter(., Sample_type == &quot;Spike&quot;, Nitrate_input != 0): object &#39;df_ts&#39; not found</code></pre>
<pre class="r"><code># Retrieved NO3
ggplot(df_ts_innate, aes(x=Nitrate_input, y=Retrieved_NO3_mM, color=Trouble_shooting, group=Trouble_shooting)) +
  geom_point(size=2.5, shape=21) +
  # geom_line(size=1)+
  geom_errorbar(aes(ymin=Retrieved_NO3_mM - Std_NO3_mM, ymax=Retrieved_NO3_mM + Std_NO3_mM), width=.05)+
  # scale_fill_brewer(palette=&#39;Set2&#39;) +
  # scale_color_manual(values = c(&quot;brown3&quot;,&quot;deepskyblue2&quot;))+
  ylab(&quot;Retrieved NO3 concentrations (mM) \n&quot;) +
  xlab(&quot;\n Nitrate_spike_in (mM)&quot;) +
  # scale_y_continuous(breaks = seq(0,2.1,0.25), limits=c(0, 2))+
  # scale_x_continuous(breaks = seq(0,2.1,0.25), limits=c(0, 2))+
  ggtitle(&quot;0.5:1:1.5 (soil:water:KCl) method-100ul extraction w/ 300ul pipet \n&quot;) +
  geom_abline(slope = 1, intercept=0, show.legend = &quot;y=x&quot;)+
  mytheme_2d</code></pre>
<pre><code>Error in ggplot(df_ts_innate, aes(x = Nitrate_input, y = Retrieved_NO3_mM, : object &#39;df_ts_innate&#39; not found</code></pre>
<pre class="r"><code># Extraction ratio
df_ts_innate$Nitrate_input &lt;- factor(df_ts_innate$Nitrate_input)</code></pre>
<pre><code>Error in factor(df_ts_innate$Nitrate_input): object &#39;df_ts_innate&#39; not found</code></pre>
<pre class="r"><code>ggplot(df_ts_innate, aes(x=Nitrate_input, y=Ratio_retrieved, fill=Trouble_shooting, group=Trouble_shooting)) +  ## I put fill=value which was wrong
  geom_bar(stat=&quot;identity&quot;,position=&quot;dodge&quot;)+
  # geom_line(size=0.2, color=&quot;brown&quot;)+
  ylab(&quot;Ratio of retrieved nitrate concentraion \n&quot;) +
  xlab(&quot;\n Nitrate_spike_in (mM)&quot;) +
  # scale_y_continuous(breaks = seq(0,1,0.1), limits=c(0, 1))+
  # scale_x_continuous(breaks = seq(0,2.1,0.25), limits=c(0, 2.1))+
  ggtitle(&quot;0.5:1:1.5 (soil:water:KCl) method-100ul extraction w/ 300ul pipet \n&quot;) +
  geom_text(aes(label = round(Ratio_retrieved,3)), size = 3, vjust = -1.5, family=&quot;serif&quot;, show.legend = FALSE, position = position_dodge(0.7))+
  mytheme_2d</code></pre>
<pre><code>Error in ggplot(df_ts_innate, aes(x = Nitrate_input, y = Ratio_retrieved, : object &#39;df_ts_innate&#39; not found</code></pre>
<p>Moisture correction factor</p>
<pre class="r"><code>df_mcf &lt;- data.frame(soil_g=NA, moisture_percent=NA, KCl_ml=NA,correction_factor=NA)
colnames(df_mcf)</code></pre>
<pre><code>[1] &quot;soil_g&quot;            &quot;moisture_percent&quot;  &quot;KCl_ml&quot;           
[4] &quot;correction_factor&quot;</code></pre>
<pre class="r"><code>dim(df_mcf)</code></pre>
<pre><code>[1] 1 4</code></pre>
<pre class="r"><code>for (soil_g in seq(0,1,0.1)){
  for (moisture_percent in seq(0,15,5)){
    for (KCl_ml in c(1,1.5,4)){
      correction_factor = (soil_g*(moisture_percent/100) + 1 + KCl_ml ) / (1 + KCl_ml) 
      df_mcf &lt;- add_row(df_mcf, soil_g, moisture_percent, KCl_ml, correction_factor)
    }
  }
}
  
dim(df_mcf)</code></pre>
<pre><code>[1] 133   4</code></pre>
<pre class="r"><code>df_mcf &lt;- df_mcf[-1,]
head(df_mcf)</code></pre>
<pre><code>  soil_g moisture_percent KCl_ml correction_factor
2      0                0    1.0                 1
3      0                0    1.5                 1
4      0                0    4.0                 1
5      0                5    1.0                 1
6      0                5    1.5                 1
7      0                5    4.0                 1</code></pre>
<pre class="r"><code>dim(df_mcf)</code></pre>
<pre><code>[1] 132   4</code></pre>
<pre class="r"><code>df_mcf$moisture_percent &lt;- factor(df_mcf$moisture_percent)
ggplot(df_mcf, aes(x=soil_g, y=correction_factor, color=moisture_percent, group=moisture_percent)) +
  facet_grid(. ~ KCl_ml) +
  geom_point(size=2.5, shape=21) +
  geom_line(size=1)+
  # scale_fill_brewer(palette=&#39;Set2&#39;) +
  # scale_color_manual(values = c(&quot;brown3&quot;,&quot;deepskyblue2&quot;))+
  ylab(&quot;Moisture correction factor \n&quot;) +
  xlab(&quot;\n Soil weight(g) in 1ml of water (Slurry ratio = soil g / water ml)&quot;) +
  # scale_y_continuous(limits=c(0.9, 1))+
  # scale_x_continuous(breaks = seq(0,2.1,0.25), limits=c(0, 2))+
  ggtitle(&quot;KCl added to soil extract (1x, 1.5x, 4x) \n&quot;) +
  mytheme_2d</code></pre>
<p><img src="figure/211020_Griess_pipet_confirm.Rmd/unnamed-chunk-7-1.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code>## for 100ul partial extraction

df_mcf_partial &lt;- data.frame(soil_g=NA, moisture_percent=NA, correction_factor=NA)
colnames(df_mcf_partial)</code></pre>
<pre><code>[1] &quot;soil_g&quot;            &quot;moisture_percent&quot;  &quot;correction_factor&quot;</code></pre>
<pre class="r"><code>dim(df_mcf_partial)</code></pre>
<pre><code>[1] 1 3</code></pre>
<pre class="r"><code>for (soil_g in seq(0,1,0.1)){
  for (moisture_percent in seq(0,15,5)){
      correction_factor = (soil_g*(moisture_percent/100) + 1)
      df_mcf_partial &lt;- add_row(df_mcf_partial, soil_g, moisture_percent, correction_factor)
  }
}
  
dim(df_mcf_partial)</code></pre>
<pre><code>[1] 45  3</code></pre>
<pre class="r"><code>df_mcf_partial &lt;- df_mcf_partial[-1,]
head(df_mcf_partial)</code></pre>
<pre><code>  soil_g moisture_percent correction_factor
2    0.0                0             1.000
3    0.0                5             1.000
4    0.0               10             1.000
5    0.0               15             1.000
6    0.1                0             1.000
7    0.1                5             1.005</code></pre>
<pre class="r"><code>dim(df_mcf_partial)</code></pre>
<pre><code>[1] 44  3</code></pre>
<pre class="r"><code>df_mcf_partial$moisture_percent &lt;- factor(df_mcf_partial$moisture_percent)
ggplot(df_mcf_partial, aes(x=soil_g, y=correction_factor, color=moisture_percent, group=moisture_percent)) +
  geom_point(size=2.5, shape=21) +
  geom_line(size=1)+
  # scale_fill_brewer(palette=&#39;Set2&#39;) +
  # scale_color_manual(values = c(&quot;brown3&quot;,&quot;deepskyblue2&quot;))+
  ylab(&quot;Moisture correction factor \n&quot;) +
  xlab(&quot;\n Soil weight(g) in 1ml of water (Slurry ratio = soil g / water ml)&quot;) +
  # scale_y_continuous(limits=c(0.9, 1))+
  # scale_x_continuous(breaks = seq(0,2.1,0.25), limits=c(0, 2))+
  ggtitle(&quot;Moisture correction factor is not affected by KCl amount \n&quot;) +
  mytheme_2d</code></pre>
<p><img src="figure/211020_Griess_pipet_confirm.Rmd/unnamed-chunk-7-2.png" width="1056" style="display: block; margin: auto;" /></p>
<br>
<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-sessioninfo" data-toggle="collapse" data-target="#workflowr-sessioninfo" style="display: block;">
<span class="glyphicon glyphicon-wrench" aria-hidden="true"></span> Session information
</button>
</p>
<div id="workflowr-sessioninfo" class="collapse">
<pre class="r"><code>sessionInfo()</code></pre>
<pre><code>R version 4.0.3 (2020-10-10)
Platform: x86_64-w64-mingw32/x64 (64-bit)
Running under: Windows 10 x64 (build 19042)

Matrix products: default

locale:
[1] LC_COLLATE=English_United States.1252 
[2] LC_CTYPE=English_United States.1252   
[3] LC_MONETARY=English_United States.1252
[4] LC_NUMERIC=C                          
[5] LC_TIME=English_United States.1252    

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] ggpubr_0.4.0       ggrepel_0.9.1      ape_5.5            openxlsx_4.2.3    
 [5] devtools_2.4.0     usethis_2.0.1      gtools_3.8.2       reshape2_1.4.4    
 [9] readxl_1.3.1       magrittr_2.0.1     forcats_0.5.1      stringr_1.4.0     
[13] purrr_0.3.4        readr_1.4.0        tidyr_1.1.3        tibble_3.0.4      
[17] tidyverse_1.3.1    vegan_2.5-7        lattice_0.20-41    permute_0.9-5     
[21] RColorBrewer_1.1-2 ggplot2_3.3.5      dplyr_1.0.5        workflowr_1.6.2   

loaded via a namespace (and not attached):
 [1] colorspace_2.0-0  ggsignif_0.6.2    ellipsis_0.3.2    rio_0.5.27       
 [5] rprojroot_2.0.2   fs_1.5.0          rstudioapi_0.13   farver_2.1.0     
 [9] remotes_2.4.0     fansi_0.4.2       lubridate_1.7.10  xml2_1.3.2       
[13] splines_4.0.3     cachem_1.0.4      knitr_1.33        pkgload_1.2.1    
[17] jsonlite_1.7.2    broom_0.7.9       cluster_2.1.0     dbplyr_2.1.1     
[21] compiler_4.0.3    httr_1.4.2        backports_1.2.1   assertthat_0.2.1 
[25] Matrix_1.2-18     fastmap_1.1.0     cli_3.0.1         later_1.2.0      
[29] htmltools_0.5.1.1 prettyunits_1.1.1 tools_4.0.3       gtable_0.3.0     
[33] glue_1.4.2        Rcpp_1.0.5        carData_3.0-4     cellranger_1.1.0 
[37] jquerylib_0.1.4   vctrs_0.3.8       nlme_3.1-149      xfun_0.22        
[41] ps_1.6.0          testthat_3.0.2    rvest_1.0.1       lifecycle_1.0.0  
[45] rstatix_0.7.0     MASS_7.3-53       scales_1.1.1      hms_1.1.0        
[49] promises_1.2.0.1  parallel_4.0.3    yaml_2.2.1        curl_4.3.2       
[53] memoise_2.0.0     sass_0.4.0        stringi_1.5.3     highr_0.9        
[57] desc_1.3.0        pkgbuild_1.2.0    zip_2.1.1         rlang_0.4.10     
[61] pkgconfig_2.0.3   evaluate_0.14     labeling_0.4.2    tidyselect_1.1.1 
[65] processx_3.5.1    plyr_1.8.6        R6_2.5.0          generics_0.1.0   
[69] DBI_1.1.1         pillar_1.6.0      haven_2.4.1       whisker_0.4      
[73] foreign_0.8-80    withr_2.4.2       mgcv_1.8-33       abind_1.4-5      
[77] modelr_0.1.8      crayon_1.4.1      car_3.0-11        utf8_1.1.4       
[81] rmarkdown_2.9     grid_4.0.3        data.table_1.14.0 callr_3.7.0      
[85] git2r_0.28.0      reprex_2.0.0      digest_0.6.27     httpuv_1.6.0     
[89] munsell_0.5.0     bslib_0.2.5.1     sessioninfo_1.1.1</code></pre>
</div>
</div>


<!-- Adjust MathJax settings so that all math formulae are shown using
TeX fonts only; see
http://docs.mathjax.org/en/latest/configuration.html.  This will make
the presentation more consistent at the cost of the webpage sometimes
taking slightly longer to load. Note that this only works because the
footer is added to webpages before the MathJax javascript. -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    "HTML-CSS": { availableFonts: ["TeX"] }
  });
</script>




</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
